# é©¾é©¶å‘˜å±é™©è¡Œä¸ºæ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunshansj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://gitee.com/qunmasj/projects)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€æ™ºèƒ½äº¤é€šç³»ç»Ÿå’Œè‡ªåŠ¨é©¾é©¶æŠ€æœ¯çš„è¿…é€Ÿå‘å±•ï¼Œé©¾é©¶å‘˜çš„å®‰å…¨è¡Œä¸ºç›‘æµ‹é€æ¸æˆä¸ºäº¤é€šå®‰å…¨ç ”ç©¶çš„é‡è¦é¢†åŸŸã€‚æ ¹æ®ä¸–ç•Œå«ç”Ÿç»„ç»‡çš„ç»Ÿè®¡ï¼Œäº¤é€šäº‹æ•…å·²æˆä¸ºå…¨çƒèŒƒå›´å†…å¯¼è‡´æ­»äº¡å’Œä¼¤æ®‹çš„ä¸»è¦åŸå› ä¹‹ä¸€ï¼Œå…¶ä¸­è®¸å¤šäº‹æ•…çš„å‘ç”Ÿä¸é©¾é©¶å‘˜çš„å±é™©è¡Œä¸ºå¯†åˆ‡ç›¸å…³ã€‚å› æ­¤ï¼Œå¼€å‘æœ‰æ•ˆçš„é©¾é©¶å‘˜å±é™©è¡Œä¸ºæ£€æµ‹ç³»ç»Ÿï¼Œä¸ä»…èƒ½å¤Ÿæé«˜é©¾é©¶å®‰å…¨æ€§ï¼Œè¿˜èƒ½ä¸ºæ™ºèƒ½äº¤é€šç®¡ç†æä¾›é‡è¦çš„æ•°æ®æ”¯æŒã€‚

è¿‘å¹´æ¥ï¼ŒåŸºäºæ·±åº¦å­¦ä¹ çš„ç›®æ ‡æ£€æµ‹æŠ€æœ¯åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸå–å¾—äº†æ˜¾è‘—è¿›å±•ï¼Œå°¤å…¶æ˜¯YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶é«˜æ•ˆæ€§å’Œå®æ—¶æ€§è€Œå¹¿æ³›åº”ç”¨äºå„ç§ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œç»“åˆäº†æ›´å…ˆè¿›çš„ç½‘ç»œç»“æ„å’Œä¼˜åŒ–ç®—æ³•ï¼Œèƒ½å¤Ÿåœ¨å¤æ‚ç¯å¢ƒä¸­å®ç°é«˜ç²¾åº¦çš„ç›®æ ‡æ£€æµ‹ã€‚åŸºäºYOLOv8çš„é©¾é©¶å‘˜å±é™©è¡Œä¸ºæ£€æµ‹ç³»ç»Ÿï¼Œèƒ½å¤Ÿå®æ—¶è¯†åˆ«é©¾é©¶å‘˜çš„çŠ¶æ€å’Œè¡Œä¸ºï¼Œä»è€Œä¸ºäº¤é€šå®‰å…¨æä¾›æœ‰æ•ˆçš„æŠ€æœ¯ä¿éšœã€‚

æœ¬ç ”ç©¶å°†é‡ç‚¹å…³æ³¨é©¾é©¶å‘˜çš„äº”ç§å±é™©è¡Œä¸ºï¼šæ¸…é†’ã€å›°å€¦ã€ä½¿ç”¨æ‰‹æœºã€æœªç³»å®‰å…¨å¸¦å’Œæ‰“å“ˆæ¬ ã€‚è¿™äº›è¡Œä¸ºåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“äº†é©¾é©¶å‘˜çš„æ³¨æ„åŠ›å’Œååº”èƒ½åŠ›ï¼Œè¿›è€Œå½±å“è¡Œè½¦å®‰å…¨ã€‚é€šè¿‡å¯¹è¿™äº”ç§è¡Œä¸ºçš„æ£€æµ‹ï¼Œç³»ç»Ÿèƒ½å¤ŸåŠæ—¶å‘å‡ºè­¦æŠ¥ï¼Œæé†’é©¾é©¶å‘˜æ³¨æ„å®‰å…¨ï¼Œé™ä½äº‹æ•…å‘ç”Ÿçš„é£é™©ã€‚ä¸ºå®ç°è¿™ä¸€ç›®æ ‡ï¼Œæœ¬ç ”ç©¶å°†ä½¿ç”¨åŒ…å«2200å¼ å›¾åƒçš„â€œdriver-safetyâ€æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†æ¶µç›–äº†å¤šç§é©¾é©¶å‘˜çŠ¶æ€ï¼Œå…·æœ‰è¾ƒé«˜çš„ä»£è¡¨æ€§å’Œå®ç”¨æ€§ã€‚

æ•°æ®é›†ä¸­çš„å›¾åƒæ•°é‡å’Œç±»åˆ«è®¾ç½®ä¸ºæœ¬ç ”ç©¶æä¾›äº†è‰¯å¥½çš„åŸºç¡€ã€‚æ¯ä¸€ç±»è¡Œä¸ºéƒ½å¯¹åº”ç€ç‰¹å®šçš„è§†è§‰ç‰¹å¾ï¼Œåˆ©ç”¨YOLOv8çš„å¼ºå¤§ç‰¹æ€§ï¼Œç³»ç»Ÿèƒ½å¤Ÿå¿«é€Ÿã€å‡†ç¡®åœ°è¯†åˆ«è¿™äº›ç‰¹å¾ï¼Œä»è€Œå®ç°å¯¹é©¾é©¶å‘˜è¡Œä¸ºçš„å®æ—¶ç›‘æµ‹ã€‚æ­¤å¤–ï¼Œæ•°æ®é›†çš„å¤šæ ·æ€§å’Œä¸°å¯Œæ€§ä¸ºæ¨¡å‹çš„è®­ç»ƒå’Œæµ‹è¯•æä¾›äº†å……è¶³çš„æ ·æœ¬ï¼Œç¡®ä¿äº†æ£€æµ‹ç³»ç»Ÿçš„é²æ£’æ€§å’Œå¯é æ€§ã€‚

æœ¬ç ”ç©¶çš„æ„ä¹‰ä¸ä»…åœ¨äºæŠ€æœ¯å±‚é¢çš„åˆ›æ–°ï¼Œæ›´åœ¨äºå…¶å¯¹ç¤¾ä¼šå®‰å…¨çš„ç§¯æå½±å“ã€‚é€šè¿‡å®ç°å¯¹é©¾é©¶å‘˜å±é™©è¡Œä¸ºçš„å®æ—¶ç›‘æµ‹ï¼Œèƒ½å¤Ÿæœ‰æ•ˆé™ä½äº¤é€šäº‹æ•…çš„å‘ç”Ÿç‡ï¼Œä¿æŠ¤é©¾é©¶å‘˜åŠä¹˜å®¢çš„ç”Ÿå‘½å®‰å…¨ã€‚åŒæ—¶ï¼Œè¯¥ç³»ç»Ÿçš„æ¨å¹¿åº”ç”¨ä¹Ÿå°†æ¨åŠ¨æ™ºèƒ½äº¤é€šæŠ€æœ¯çš„å‘å±•ï¼Œä¸ºæœªæ¥çš„æ™ºèƒ½é©¾é©¶æä¾›é‡è¦çš„å‚è€ƒå’Œå€Ÿé‰´ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„é©¾é©¶å‘˜å±é™©è¡Œä¸ºæ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œæ—¢æ˜¯å¯¹ç°æœ‰æŠ€æœ¯çš„å»¶ç»­ä¸åˆ›æ–°ï¼Œä¹Ÿæ˜¯å¯¹äº¤é€šå®‰å…¨é—®é¢˜çš„ç§¯æå›åº”ã€‚é€šè¿‡æœ¬ç ”ç©¶çš„æ·±å…¥ï¼ŒæœŸæœ›èƒ½å¤Ÿä¸ºæå‡é©¾é©¶å®‰å…¨ã€å‡å°‘äº¤é€šäº‹æ•…æä¾›åˆ‡å®å¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œä¸ºæ„å»ºæ›´åŠ å®‰å…¨çš„äº¤é€šç¯å¢ƒè´¡çŒ®åŠ›é‡ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1nt4UeAEv1/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 5
names: ['awake', 'drowsy', 'phone', 'seatbelt', 'yawn']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨ç°ä»£æ™ºèƒ½äº¤é€šç³»ç»Ÿä¸­ï¼Œé©¾é©¶å‘˜çš„è¡Œä¸ºç›‘æµ‹ä¸åˆ†æå·²æˆä¸ºæé«˜é“è·¯å®‰å…¨æ€§çš„é‡è¦ç¯èŠ‚ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªåä¸ºâ€œdriver-safetyâ€çš„æ•°æ®é›†ï¼Œæ—¨åœ¨ä¸ºæ”¹è¿›YOLOv8çš„é©¾é©¶å‘˜å±é™©è¡Œä¸ºæ£€æµ‹ç³»ç»Ÿæä¾›ä¸°å¯Œçš„è®­ç»ƒæ•°æ®ã€‚è¯¥æ•°æ®é›†åŒ…å«äº”ä¸ªä¸»è¦ç±»åˆ«ï¼Œåˆ†åˆ«æ˜¯â€œawakeâ€ï¼ˆæ¸…é†’ï¼‰ã€â€œdrowsyâ€ï¼ˆå›°å€¦ï¼‰ã€â€œphoneâ€ï¼ˆä½¿ç”¨æ‰‹æœºï¼‰ã€â€œseatbeltâ€ï¼ˆæœªç³»å®‰å…¨å¸¦ï¼‰å’Œâ€œyawnâ€ï¼ˆæ‰“å“ˆæ¬ ï¼‰ã€‚è¿™äº›ç±»åˆ«æ¶µç›–äº†é©¾é©¶å‘˜åœ¨è¡Œé©¶è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„å¤šç§å±é™©è¡Œä¸ºï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¸®åŠ©æ¨¡å‹è¯†åˆ«å¹¶åˆ¤æ–­é©¾é©¶å‘˜çš„çŠ¶æ€ï¼Œä»è€Œä¸ºå®‰å…¨é©¾é©¶æä¾›é¢„è­¦ã€‚

â€œdriver-safetyâ€æ•°æ®é›†çš„æ„å»ºåŸºäºå¯¹çœŸå®é©¾é©¶åœºæ™¯çš„æ·±å…¥åˆ†æä¸è§‚å¯Ÿã€‚æˆ‘ä»¬é€šè¿‡å¤šç§é€”å¾„æ”¶é›†äº†å¤§é‡è§†é¢‘å’Œå›¾åƒæ•°æ®ï¼Œç¡®ä¿æ ·æœ¬çš„å¤šæ ·æ€§å’Œä»£è¡¨æ€§ã€‚è¿™äº›æ•°æ®ä¸ä»…æ¥è‡ªä¸åŒçš„é©¾é©¶ç¯å¢ƒï¼Œå¦‚åŸå¸‚é“è·¯ã€é«˜é€Ÿå…¬è·¯å’Œä¹¡æ‘å°é“ï¼Œè¿˜æ¶µç›–äº†ä¸åŒçš„å¤©æ°”æ¡ä»¶å’Œæ—¶é—´æ®µï¼Œä»¥å¢å¼ºæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚æ•°æ®é›†ä¸­æ¯ä¸ªç±»åˆ«çš„æ ·æœ¬å‡ç»è¿‡ç²¾å¿ƒæ ‡æ³¨ï¼Œç¡®ä¿å…¶å‡†ç¡®æ€§å’Œä¸€è‡´æ€§ï¼Œä¸ºåç»­çš„æ¨¡å‹è®­ç»ƒæä¾›äº†åšå®çš„åŸºç¡€ã€‚

åœ¨æ•°æ®é›†çš„è®¾è®¡ä¸Šï¼Œæˆ‘ä»¬ç‰¹åˆ«å…³æ³¨äº†é©¾é©¶å‘˜è¡Œä¸ºçš„å¤šæ ·æ€§å’Œå¤æ‚æ€§ã€‚ä¾‹å¦‚ï¼Œåœ¨â€œdrowsyâ€ç±»åˆ«ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…åŒ…æ‹¬äº†è½»å¾®çš„å›°å€¦è¡¨ç°ï¼Œè¿˜æ¶µç›–äº†æ˜æ˜¾çš„æ‰“çŒç¡çŠ¶æ€ï¼Œä»¥ä¾¿æ¨¡å‹èƒ½å¤Ÿåœ¨ä¸åŒç¨‹åº¦çš„å›°å€¦æƒ…å†µä¸‹åšå‡ºæœ‰æ•ˆåˆ¤æ–­ã€‚è€Œåœ¨â€œphoneâ€ç±»åˆ«ä¸­ï¼Œæˆ‘ä»¬åˆ™æ ‡æ³¨äº†é©¾é©¶å‘˜åœ¨ä½¿ç”¨æ‰‹æœºæ—¶çš„å¤šç§å§¿æ€ï¼ŒåŒ…æ‹¬å•æ‰‹æŒæœºã€åŒæ‰‹æ“ä½œç­‰ï¼Œç¡®ä¿æ¨¡å‹èƒ½å¤Ÿè¯†åˆ«å‡ºå„ç§ä½¿ç”¨æ‰‹æœºçš„å±é™©è¡Œä¸ºã€‚

æ­¤å¤–ï¼Œä¸ºäº†æå‡æ•°æ®é›†çš„å®ç”¨æ€§ï¼Œæˆ‘ä»¬è¿˜å¯¹æ ·æœ¬è¿›è¡Œäº†å¤šæ ·åŒ–å¤„ç†ï¼ŒåŒ…æ‹¬ä¸åŒçš„æ‹æ‘„è§’åº¦ã€å…‰ç…§æ¡ä»¶å’ŒèƒŒæ™¯ç¯å¢ƒã€‚è¿™ç§å¤šæ ·æ€§ä¸ä»…å¢åŠ äº†æ•°æ®é›†çš„ä¸°å¯Œæ€§ï¼Œä¹Ÿä½¿å¾—æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”å„ç§å¤æ‚çš„é©¾é©¶åœºæ™¯ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œè¿™ç§ç²¾å¿ƒè®¾è®¡çš„æ•°æ®é›†å°†ä¸ºYOLOv8çš„è®­ç»ƒæä¾›å¼ºæœ‰åŠ›çš„æ”¯æŒï¼Œä½¿å…¶åœ¨é©¾é©¶å‘˜å±é™©è¡Œä¸ºæ£€æµ‹ä»»åŠ¡ä¸­è¡¨ç°æ›´åŠ å‡ºè‰²ã€‚

åœ¨æ•°æ®é›†çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é¼“åŠ±ç ”ç©¶äººå‘˜å’Œå¼€å‘è€…ç§¯æå‚ä¸åˆ°æ•°æ®é›†çš„æ”¹è¿›ä¸æ‰©å±•ä¸­æ¥ã€‚é€šè¿‡ä¸æ–­æ”¶é›†æ–°çš„æ ·æœ¬å’Œåé¦ˆï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤ŸæŒç»­ä¼˜åŒ–â€œdriver-safetyâ€æ•°æ®é›†ï¼Œä½¿å…¶åœ¨é©¾é©¶å‘˜è¡Œä¸ºæ£€æµ‹é¢†åŸŸå‘æŒ¥æ›´å¤§çš„ä½œç”¨ã€‚æœªæ¥ï¼Œæˆ‘ä»¬è®¡åˆ’å¼•å…¥æ›´å¤šçš„ç±»åˆ«å’Œæ ·æœ¬ï¼Œä»¥åº”å¯¹ä¸æ–­å˜åŒ–çš„é©¾é©¶ç¯å¢ƒå’Œè¡Œä¸ºæ¨¡å¼ï¼Œç¡®ä¿æˆ‘ä»¬çš„æ£€æµ‹ç³»ç»Ÿå§‹ç»ˆå¤„äºæŠ€æœ¯å‰æ²¿ã€‚

æ€»ä¹‹ï¼Œâ€œdriver-safetyâ€æ•°æ®é›†çš„æ„å»ºä¸åº”ç”¨ï¼Œä¸ä»…ä¸ºé©¾é©¶å‘˜å±é™©è¡Œä¸ºæ£€æµ‹æä¾›äº†é‡è¦çš„åŸºç¡€æ•°æ®æ”¯æŒï¼Œä¹Ÿä¸ºæ™ºèƒ½äº¤é€šç³»ç»Ÿçš„å®‰å…¨æ€§æå‡è´¡çŒ®äº†åŠ›é‡ã€‚é€šè¿‡ç»“åˆå…ˆè¿›çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯ï¼Œæˆ‘ä»¬æœŸå¾…åœ¨æœªæ¥çš„ç ”ç©¶ä¸­ï¼Œèƒ½å¤Ÿå®ç°æ›´é«˜æ•ˆã€æ›´å‡†ç¡®çš„é©¾é©¶å‘˜è¡Œä¸ºç›‘æµ‹ï¼Œä¸ºé“è·¯å®‰å…¨ä¿é©¾æŠ¤èˆªã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOv8ç®—æ³•æ˜¯ç”±Glenn-Jocheræå‡ºçš„æœ€æ–°ä¸€ä»£YOLOç³»åˆ—ç›®æ ‡æ£€æµ‹ç®—æ³•ï¼Œå®ƒåœ¨YOLOv3å’ŒYOLOv5çš„åŸºç¡€ä¸Šè¿›è¡Œäº†å¤šé¡¹é‡è¦æ”¹è¿›ï¼Œæ—¨åœ¨æå‡ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ã€‚YOLOv8çš„è®¾è®¡ç†å¿µæ˜¯é€šè¿‡é«˜æ•ˆçš„ç½‘ç»œç»“æ„å’Œåˆ›æ–°çš„æŸå¤±å‡½æ•°ï¼Œä¼˜åŒ–ç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚ç¯å¢ƒä¸‹çš„è¡¨ç°ã€‚

é¦–å…ˆï¼ŒYOLOv8åœ¨æ•°æ®é¢„å¤„ç†é˜¶æ®µé‡‡ç”¨äº†å¤šç§å¢å¼ºæ‰‹æ®µï¼ŒåŒ…æ‹¬é©¬èµ›å…‹å¢å¼ºã€æ··åˆå¢å¼ºã€ç©ºé—´æ‰°åŠ¨å’Œé¢œè‰²æ‰°åŠ¨ç­‰ã€‚è¿™äº›å¢å¼ºæŠ€æœ¯çš„å¼•å…¥ï¼Œæ—¨åœ¨æé«˜æ¨¡å‹å¯¹ä¸åŒåœºæ™¯å’Œç‰©ä½“çš„é€‚åº”èƒ½åŠ›ï¼Œä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿå­¦ä¹ åˆ°æ›´ä¸ºä¸°å¯Œçš„ç‰¹å¾ï¼Œä»è€Œåœ¨å®é™…åº”ç”¨ä¸­è¡¨ç°å‡ºæ›´å¥½çš„é²æ£’æ€§ã€‚

åœ¨ä¸»å¹²ç½‘ç»œçš„è®¾è®¡ä¸Šï¼ŒYOLOv8å»¶ç»­äº†YOLOv5çš„ç»“æ„ç‰¹ç‚¹ï¼Œä½†å¯¹å…¶è¿›è¡Œäº†ä¼˜åŒ–ã€‚YOLOv8å°†åŸæœ‰çš„C3æ¨¡å—æ›¿æ¢ä¸ºC2fæ¨¡å—ï¼ŒC2fæ¨¡å—é€šè¿‡å¼•å…¥æ›´å¤šçš„åˆ†æ”¯ï¼Œå¢å¼ºäº†æ¢¯åº¦å›ä¼ è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æµåŠ¨ã€‚è¿™ç§è®¾è®¡ä½¿å¾—ç‰¹å¾æå–æ›´åŠ é«˜æ•ˆï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰åˆ°å›¾åƒä¸­çš„ç»†èŠ‚ä¿¡æ¯ã€‚C2fæ¨¡å—çš„å¼•å…¥ä¸ä»…æå‡äº†ç‰¹å¾æå–çš„èƒ½åŠ›ï¼Œè¿˜åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡è½»äº†å™ªå£°å¯¹æ¨¡å‹æ€§èƒ½çš„å½±å“ã€‚

YOLOv8çš„Neckç«¯é‡‡ç”¨äº†FPNï¼ˆç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼‰å’ŒPANï¼ˆè·¯å¾„èšåˆç½‘ç»œï¼‰çš„ç»“åˆç»“æ„ï¼Œè¿™ä¸€è®¾è®¡ä½¿å¾—å¤šå°ºåº¦ç‰¹å¾èƒ½å¤Ÿå¾—åˆ°å……åˆ†èåˆã€‚é€šè¿‡ä¸Šé‡‡æ ·å’Œä¸‹é‡‡æ ·çš„æ“ä½œï¼ŒYOLOv8èƒ½å¤Ÿåœ¨ä¸åŒçš„å°ºåº¦ä¸Šè¿›è¡Œç‰¹å¾çš„èšåˆï¼Œä»è€Œæå‡å¯¹å°ç›®æ ‡çš„æ£€æµ‹èƒ½åŠ›ã€‚ç‰¹åˆ«æ˜¯åœ¨å¤æ‚çš„èƒŒæ™¯ä¸‹ï¼ŒFPN-PANç»“æ„çš„æœ‰æ•ˆæ€§æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©æ¨¡å‹æ›´å¥½åœ°åˆ†ç¦»ç›®æ ‡ä¸èƒŒæ™¯ï¼Œæé«˜ç›®æ ‡å®šä½çš„å‡†ç¡®æ€§ã€‚

åœ¨è¾“å‡ºç«¯ï¼ŒYOLOv8é‡‡ç”¨äº†è§£è€¦å¤´ç»“æ„ï¼Œåˆ†åˆ«å¤„ç†åˆ†ç±»å’Œå›å½’ä»»åŠ¡ã€‚è¿™ç§è§£è€¦è®¾è®¡çš„ä¼˜åŠ¿åœ¨äºï¼Œå®ƒå…è®¸æ¨¡å‹åœ¨åˆ†ç±»å’Œå®šä½ä¸Šè¿›è¡Œç‹¬ç«‹ä¼˜åŒ–ï¼Œä»è€Œæé«˜äº†æ•´ä½“çš„æ£€æµ‹æ€§èƒ½ã€‚é€šè¿‡å¹¶è¡Œçš„åˆ†æ”¯ç»“æ„ï¼ŒYOLOv8èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°æå–ç±»åˆ«ç‰¹å¾å’Œä½ç½®ç‰¹å¾ï¼Œæœ€ç»ˆå®ç°é«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹ã€‚

YOLOv8åœ¨æ ‡ç­¾åˆ†é…ç­–ç•¥ä¸Šä¹Ÿè¿›è¡Œäº†åˆ›æ–°ï¼Œé‡‡ç”¨äº†åŠ¨æ€æ ‡ç­¾åˆ†é…ç­–ç•¥ï¼Œè€Œéä¾èµ–äºé™æ€çš„å€™é€‰æ¡†ã€‚è¿™ä¸€ç­–ç•¥ä½¿å¾—YOLOv8èƒ½å¤Ÿæ ¹æ®ç›®æ ‡çš„å®é™…åˆ†å¸ƒæƒ…å†µåŠ¨æ€è°ƒæ•´æ­£è´Ÿæ ·æœ¬çš„åŒ¹é…ï¼Œä»è€Œæé«˜äº†è®­ç»ƒçš„çµæ´»æ€§å’Œå‡†ç¡®æ€§ã€‚YOLOv8çš„æŸå¤±å‡½æ•°è®¾è®¡åŒæ ·å€¼å¾—å…³æ³¨ï¼Œå…¶åˆ†ç±»æŸå¤±é‡‡ç”¨äº†Varifocal Lossï¼Œå›å½’æŸå¤±åˆ™ç»“åˆäº†CIoUå’ŒDFLæŸå¤±ã€‚è¿™ç§å¤šæ ·åŒ–çš„æŸå¤±å‡½æ•°è®¾è®¡ï¼Œä½¿å¾—æ¨¡å‹åœ¨å¤„ç†ä¸åŒç±»å‹çš„æ ·æœ¬æ—¶èƒ½å¤Ÿæ›´å…·é’ˆå¯¹æ€§ï¼Œè¿›ä¸€æ­¥æå‡äº†æ£€æµ‹çš„ç²¾åº¦ã€‚

å°½ç®¡YOLOv8åœ¨è®¸å¤šæ–¹é¢éƒ½å–å¾—äº†æ˜¾è‘—çš„è¿›æ­¥ï¼Œä½†åœ¨å¤æ‚æ°´é¢ç¯å¢ƒä¸‹çš„åº”ç”¨ä»ç„¶é¢ä¸´æŒ‘æˆ˜ã€‚å°ç›®æ ‡æ¼‚æµ®ç‰©çš„ç‰¹å¾å¤æ‚ä¸”èƒŒæ™¯å¤šæ ·ï¼Œå¯¼è‡´YOLOv8åœ¨è¿™äº›åœºæ™¯ä¸‹çš„å®šä½ç²¾åº¦å’Œç›®æ ‡æ„ŸçŸ¥èƒ½åŠ›ä¸è¶³ã€‚å› æ­¤ï¼Œé’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œç ”ç©¶è€…ä»¬æå‡ºäº†YOLOv8-WSSODç®—æ³•çš„æ”¹è¿›æ–¹æ¡ˆï¼Œä»¥è¿›ä¸€æ­¥æå‡YOLOv8åœ¨å¤æ‚ç¯å¢ƒä¸‹çš„è¡¨ç°ã€‚

YOLOv8-WSSODç®—æ³•çš„æ”¹è¿›ä¸»è¦ä½“ç°åœ¨å‡ ä¸ªæ–¹é¢ã€‚é¦–å…ˆï¼Œä¸ºäº†å‡è½»ä¸»å¹²ç½‘ç»œä¸‹é‡‡æ ·è¿‡ç¨‹ä¸­çš„å™ªå£°å½±å“ï¼ŒYOLOv8-WSSODå¼•å…¥äº†æ•è·è¿œç¨‹ä¾èµ–çš„æ€æƒ³ï¼Œé‡‡ç”¨äº†BiFormeråŒå±‚è·¯ç”±æ³¨æ„åŠ›æœºåˆ¶æ„å»ºC2fBFæ¨¡å—ã€‚è¿™ä¸€æ¨¡å—çš„è®¾è®¡æ—¨åœ¨ä¿ç•™ç‰¹å¾æå–è¿‡ç¨‹ä¸­æ›´ç»†ç²’åº¦çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»è€Œæé«˜æ¨¡å‹å¯¹å°ç›®æ ‡çš„æ„ŸçŸ¥èƒ½åŠ›ã€‚

å…¶æ¬¡ï¼ŒYOLOv8-WSSODé’ˆå¯¹å°ç›®æ ‡æ¼æ£€é—®é¢˜ï¼Œæ·»åŠ äº†ä¸€ä¸ªæ›´å°çš„æ£€æµ‹å¤´ï¼Œä»¥æå‡ç½‘ç»œå¯¹å°ç›®æ ‡çš„æ„ŸçŸ¥åŠ›ã€‚åŒæ—¶ï¼Œåœ¨Neckç«¯å¼•å…¥GSConvå’ŒSlim-neckæŠ€æœ¯ï¼Œæ—¨åœ¨ä¿æŒæ£€æµ‹ç²¾åº¦çš„åŒæ—¶é™ä½è®¡ç®—é‡ï¼Œè¿›ä¸€æ­¥æå‡æ¨¡å‹çš„æ•ˆç‡ã€‚

æœ€åï¼ŒYOLOv8-WSSODä½¿ç”¨MPDIoUæŸå¤±å‡½æ•°æ›¿æ¢äº†CIoUæŸå¤±å‡½æ•°ï¼Œä»¥æé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œç²¾å‡†åº¦ã€‚è¿™ä¸€æŸå¤±å‡½æ•°çš„å¼•å…¥ï¼Œä½¿å¾—æ¨¡å‹åœ¨å¤„ç†å¤æ‚åœºæ™¯æ—¶èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”ä¸åŒçš„ç›®æ ‡åˆ†å¸ƒï¼Œæé«˜äº†æ£€æµ‹çš„ç¨³å®šæ€§ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒYOLOv8ç®—æ³•é€šè¿‡ä¸€ç³»åˆ—åˆ›æ–°çš„è®¾è®¡å’Œæ”¹è¿›ï¼Œæå‡äº†ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚ç¯å¢ƒä¸‹çš„è¡¨ç°ã€‚å°½ç®¡ä»å­˜åœ¨ä¸€äº›æŒ‘æˆ˜ï¼Œä½†é€šè¿‡ä¸æ–­çš„ç ”ç©¶å’Œæ”¹è¿›ï¼ŒYOLOv8åŠå…¶è¡ç”Ÿç®—æ³•æœ‰æœ›åœ¨å®é™…åº”ç”¨ä¸­å±•ç°å‡ºæ›´å¼ºçš„èƒ½åŠ›ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 code\ultralytics\solutions\ai_gym.py

ä»¥ä¸‹æ˜¯å¯¹ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œçš„åˆ†æå’Œè¯¦ç»†æ³¨é‡Šï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license

import cv2
from ultralytics.utils.checks import check_imshow
from ultralytics.utils.plotting import Annotator

class AIGym:
    """ç”¨äºç®¡ç†åŸºäºå§¿åŠ¿çš„å®æ—¶è§†é¢‘æµä¸­çš„å¥èº«æ­¥éª¤çš„ç±»ã€‚"""

    def __init__(self):
        """åˆå§‹åŒ– AIGymï¼Œè®¾ç½®è§†è§‰å’Œå›¾åƒå‚æ•°çš„é»˜è®¤å€¼ã€‚"""
        self.im0 = None  # å½“å‰å¸§å›¾åƒ
        self.tf = None   # çº¿æ¡åšåº¦

        # å…³é”®ç‚¹å’Œè®¡æ•°ä¿¡æ¯
        self.keypoints = None  # å§¿åŠ¿å…³é”®ç‚¹
        self.poseup_angle = None  # ä¸Šå‡å§¿åŠ¿è§’åº¦
        self.posedown_angle = None  # ä¸‹é™å§¿åŠ¿è§’åº¦
        self.threshold = 0.001  # é˜ˆå€¼

        # å­˜å‚¨é˜¶æ®µã€è®¡æ•°å’Œè§’åº¦ä¿¡æ¯
        self.angle = None  # å½“å‰è§’åº¦
        self.count = None  # å½“å‰è®¡æ•°
        self.stage = None  # å½“å‰é˜¶æ®µ
        self.pose_type = "pushup"  # å§¿åŠ¿ç±»å‹
        self.kpts_to_check = None  # è¦æ£€æŸ¥çš„å…³é”®ç‚¹

        # è§†è§‰ä¿¡æ¯
        self.view_img = False  # æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
        self.annotator = None  # æ³¨é‡Šå™¨å®ä¾‹

        # æ£€æŸ¥ç¯å¢ƒæ˜¯å¦æ”¯æŒ imshow
        self.env_check = check_imshow(warn=True)

    def set_args(self, kpts_to_check, line_thickness=2, view_img=False, pose_up_angle=145.0, pose_down_angle=90.0, pose_type="pullup"):
        """
        é…ç½® AIGym çš„å‚æ•°ã€‚
        Args:
            kpts_to_check (list): ç”¨äºè®¡æ•°çš„ 3 ä¸ªå…³é”®ç‚¹
            line_thickness (int): è¾¹ç•Œæ¡†çš„çº¿æ¡åšåº¦
            view_img (bool): æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
            pose_up_angle (float): è®¾ç½®ä¸Šå‡å§¿åŠ¿çš„è§’åº¦
            pose_down_angle (float): è®¾ç½®ä¸‹é™å§¿åŠ¿çš„è§’åº¦
            pose_type: "pushup", "pullup" æˆ– "abworkout"
        """
        self.kpts_to_check = kpts_to_check  # è®¾ç½®è¦æ£€æŸ¥çš„å…³é”®ç‚¹
        self.tf = line_thickness  # è®¾ç½®çº¿æ¡åšåº¦
        self.view_img = view_img  # è®¾ç½®æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
        self.poseup_angle = pose_up_angle  # è®¾ç½®ä¸Šå‡å§¿åŠ¿è§’åº¦
        self.posedown_angle = pose_down_angle  # è®¾ç½®ä¸‹é™å§¿åŠ¿è§’åº¦
        self.pose_type = pose_type  # è®¾ç½®å§¿åŠ¿ç±»å‹

    def start_counting(self, im0, results, frame_count):
        """
        ç”¨äºè®¡æ•°å¥èº«æ­¥éª¤çš„å‡½æ•°ã€‚
        Args:
            im0 (ndarray): å½“å‰è§†é¢‘æµå¸§
            results: å§¿åŠ¿ä¼°è®¡æ•°æ®
            frame_count: å½“å‰å¸§è®¡æ•°
        """
        self.im0 = im0  # ä¿å­˜å½“å‰å¸§å›¾åƒ
        if frame_count == 1:
            # åˆå§‹åŒ–è®¡æ•°ã€è§’åº¦å’Œé˜¶æ®µ
            self.count = [0] * len(results[0])
            self.angle = [0] * len(results[0])
            self.stage = ["-" for _ in results[0]]
        
        self.keypoints = results[0].keypoints.data  # è·å–å…³é”®ç‚¹æ•°æ®
        self.annotator = Annotator(im0, line_width=2)  # åˆ›å»ºæ³¨é‡Šå™¨å®ä¾‹

        num_keypoints = len(results[0])  # è·å–å…³é”®ç‚¹æ•°é‡

        # å¦‚æœå…³é”®ç‚¹æ•°é‡å˜åŒ–ï¼Œè°ƒæ•´è§’åº¦ã€è®¡æ•°å’Œé˜¶æ®µçš„å¤§å°
        if len(self.angle) != num_keypoints:
            self.angle = [0] * num_keypoints
            self.count = [0] * num_keypoints
            self.stage = ["-" for _ in range(num_keypoints)]

        # éå†æ¯ä¸ªå…³é”®ç‚¹ï¼Œè¿›è¡Œå§¿åŠ¿è§’åº¦ä¼°è®¡å’Œè®¡æ•°
        for ind, k in enumerate(reversed(self.keypoints)):
            # è®¡ç®—å§¿åŠ¿è§’åº¦
            self.angle[ind] = self.annotator.estimate_pose_angle(
                k[int(self.kpts_to_check[0])].cpu(),
                k[int(self.kpts_to_check[1])].cpu(),
                k[int(self.kpts_to_check[2])].cpu(),
            )
            # ç»˜åˆ¶å…³é”®ç‚¹
            self.im0 = self.annotator.draw_specific_points(k, self.kpts_to_check, shape=(640, 640), radius=10)

            # æ ¹æ®å§¿åŠ¿ç±»å‹æ›´æ–°é˜¶æ®µå’Œè®¡æ•°
            if self.pose_type == "pushup":
                if self.angle[ind] > self.poseup_angle:
                    self.stage[ind] = "up"
                if self.angle[ind] < self.posedown_angle and self.stage[ind] == "up":
                    self.stage[ind] = "down"
                    self.count[ind] += 1
            
            elif self.pose_type == "pullup":
                if self.angle[ind] > self.poseup_angle:
                    self.stage[ind] = "down"
                if self.angle[ind] < self.posedown_angle and self.stage[ind] == "down":
                    self.stage[ind] = "up"
                    self.count[ind] += 1
            
            # ç»˜åˆ¶è§’åº¦ã€è®¡æ•°å’Œé˜¶æ®µä¿¡æ¯
            self.annotator.plot_angle_and_count_and_stage(
                angle_text=self.angle[ind],
                count_text=self.count[ind],
                stage_text=self.stage[ind],
                center_kpt=k[int(self.kpts_to_check[1])],
                line_thickness=self.tf,
            )

            # ç»˜åˆ¶æ‰€æœ‰å…³é”®ç‚¹
            self.annotator.kpts(k, shape=(640, 640), radius=1, kpt_line=True)

        # å¦‚æœç¯å¢ƒæ”¯æŒå¹¶ä¸”éœ€è¦æ˜¾ç¤ºå›¾åƒï¼Œåˆ™å±•ç¤ºå½“å‰å¸§
        if self.env_check and self.view_img:
            cv2.imshow("Ultralytics YOLOv8 AI GYM", self.im0)
            if cv2.waitKey(1) & 0xFF == ord("q"):
                return

        return self.im0  # è¿”å›å¤„ç†åçš„å›¾åƒ

if __name__ == "__main__":
    AIGym()  # åˆ›å»º AIGym å®ä¾‹
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åˆ†æï¼š
1. **ç±»å®šä¹‰å’Œåˆå§‹åŒ–**ï¼š`AIGym`ç±»ç”¨äºç®¡ç†å¥èº«åŠ¨ä½œçš„è®¡æ•°å’Œå§¿åŠ¿ä¼°è®¡ï¼Œåˆå§‹åŒ–æ—¶è®¾ç½®äº†ä¸€äº›é»˜è®¤å‚æ•°ã€‚
2. **å‚æ•°è®¾ç½®**ï¼š`set_args`æ–¹æ³•ç”¨äºé…ç½®å…³é”®ç‚¹ã€çº¿æ¡åšåº¦ã€æ˜¯å¦æ˜¾ç¤ºå›¾åƒç­‰å‚æ•°ã€‚
3. **è®¡æ•°é€»è¾‘**ï¼š`start_counting`æ–¹æ³•æ˜¯æ ¸å¿ƒåŠŸèƒ½ï¼Œå¤„ç†æ¯ä¸€å¸§å›¾åƒï¼Œä¼°è®¡å§¿åŠ¿è§’åº¦ï¼Œæ›´æ–°è®¡æ•°å’Œé˜¶æ®µï¼Œå¹¶ç»˜åˆ¶ç›¸å…³ä¿¡æ¯ã€‚
4. **ç¯å¢ƒæ£€æŸ¥**ï¼šä½¿ç”¨`check_imshow`æ£€æŸ¥ç¯å¢ƒæ˜¯å¦æ”¯æŒå›¾åƒæ˜¾ç¤ºï¼Œå¹¶åœ¨éœ€è¦æ—¶å±•ç¤ºå›¾åƒã€‚

é€šè¿‡è¿™äº›æ ¸å¿ƒéƒ¨åˆ†ï¼Œä»£ç å®ç°äº†å¯¹å¥èº«åŠ¨ä½œçš„å®æ—¶ç›‘æµ‹å’Œè®¡æ•°åŠŸèƒ½ã€‚

è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `AIGym` çš„ç±»ï¼Œä¸»è¦ç”¨äºåœ¨å®æ—¶è§†é¢‘æµä¸­åŸºäºäººä½“å§¿æ€æ¥ç®¡ç†å¥èº«åŠ¨ä½œçš„è®¡æ•°ã€‚ç±»çš„æ„é€ å‡½æ•°åˆå§‹åŒ–äº†ä¸€äº›é»˜è®¤å€¼ï¼ŒåŒ…æ‹¬å›¾åƒå‚æ•°ã€å…³é”®ç‚¹ä¿¡æ¯ã€è®¡æ•°å’Œè§’åº¦ç­‰ã€‚

åœ¨ `__init__` æ–¹æ³•ä¸­ï¼Œé¦–å…ˆå®šä¹‰äº†ä¸€äº›å®ä¾‹å˜é‡ï¼Œä¾‹å¦‚ `im0` ç”¨äºå­˜å‚¨å½“å‰å¸§å›¾åƒï¼Œ`tf` ç”¨äºçº¿æ¡çš„åšåº¦ï¼Œ`keypoints` ç”¨äºå­˜å‚¨å…³é”®ç‚¹æ•°æ®ï¼Œ`poseup_angle` å’Œ `posedown_angle` ç”¨äºè®¾å®šå§¿æ€çš„ä¸Šä¸‹è§’åº¦é˜ˆå€¼ï¼Œ`count` å’Œ `stage` ç”¨äºå­˜å‚¨æ¯ä¸ªå…³é”®ç‚¹çš„è®¡æ•°å’Œå½“å‰é˜¶æ®µã€‚`pose_type` å˜é‡ç”¨äºæŒ‡å®šå½“å‰çš„å¥èº«åŠ¨ä½œç±»å‹ï¼ˆå¦‚ä¿¯å§æ’‘ã€å¼•ä½“å‘ä¸Šæˆ–è…¹éƒ¨é”»ç‚¼ï¼‰ï¼Œè€Œ `view_img` åˆ™ç”¨äºæ§åˆ¶æ˜¯å¦æ˜¾ç¤ºå›¾åƒã€‚

`set_args` æ–¹æ³•ç”¨äºé…ç½® `AIGym` çš„ä¸€äº›å‚æ•°ï¼ŒåŒ…æ‹¬éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹ã€çº¿æ¡åšåº¦ã€æ˜¯å¦æ˜¾ç¤ºå›¾åƒä»¥åŠä¸Šä¸‹è§’åº¦é˜ˆå€¼ç­‰ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ç”¨æˆ·æ ¹æ®ä¸åŒçš„å¥èº«åŠ¨ä½œè¿›è¡Œè‡ªå®šä¹‰è®¾ç½®ã€‚

`start_counting` æ–¹æ³•æ˜¯ä¸»è¦çš„è®¡æ•°é€»è¾‘ï¼Œæ¥å—å½“å‰å¸§å›¾åƒã€å§¿æ€ä¼°è®¡ç»“æœå’Œå¸§è®¡æ•°ä½œä¸ºå‚æ•°ã€‚è¯¥æ–¹æ³•é¦–å…ˆæ£€æŸ¥å¸§è®¡æ•°ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€å¸§ï¼Œåˆ™åˆå§‹åŒ–è®¡æ•°ã€è§’åº¦å’Œé˜¶æ®µçš„åˆ—è¡¨ã€‚æ¥ç€ï¼Œå®ƒä»ç»“æœä¸­æå–å…³é”®ç‚¹æ•°æ®ï¼Œå¹¶ä½¿ç”¨ `Annotator` ç±»æ¥å¤„ç†å›¾åƒæ ‡æ³¨ã€‚

åœ¨å¤„ç†æ¯ä¸ªå…³é”®ç‚¹æ—¶ï¼Œç¨‹åºæ ¹æ®ä¸åŒçš„å¥èº«åŠ¨ä½œç±»å‹ï¼ˆä¿¯å§æ’‘ã€å¼•ä½“å‘ä¸Šæˆ–è…¹éƒ¨é”»ç‚¼ï¼‰è®¡ç®—è§’åº¦ï¼Œå¹¶åˆ¤æ–­å½“å‰çš„åŠ¨ä½œé˜¶æ®µï¼ˆå¦‚â€œä¸Šâ€æˆ–â€œä¸‹â€ï¼‰ã€‚æ ¹æ®è§’åº¦çš„å˜åŒ–ï¼Œæ›´æ–°è®¡æ•°å’Œé˜¶æ®µï¼Œå¹¶åœ¨å›¾åƒä¸Šç»˜åˆ¶ç›¸åº”çš„æ ‡æ³¨ï¼ŒåŒ…æ‹¬è§’åº¦ã€è®¡æ•°å’Œé˜¶æ®µä¿¡æ¯ã€‚

æœ€åï¼Œå¦‚æœç¯å¢ƒæ”¯æŒå›¾åƒæ˜¾ç¤ºä¸”è®¾ç½®ä¸ºæ˜¾ç¤ºå›¾åƒï¼Œç¨‹åºä¼šä½¿ç”¨ OpenCV æ˜¾ç¤ºå½“å‰å¤„ç†çš„å›¾åƒï¼Œå¹¶åœ¨æŒ‰ä¸‹â€œqâ€é”®æ—¶é€€å‡ºæ˜¾ç¤ºã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç±»æä¾›äº†ä¸€ç§åŸºäºè§†é¢‘æµå®æ—¶ç›‘æµ‹å’Œè®¡æ•°å¥èº«åŠ¨ä½œçš„æ–¹å¼ï¼Œç»“åˆäº†å§¿æ€ä¼°è®¡å’Œå›¾åƒå¤„ç†æŠ€æœ¯ã€‚

#### 11.2 ui.py

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤
    result = subprocess.run(command, shell=True)
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")


# å®ä¾‹åŒ–å¹¶è¿è¡Œåº”ç”¨
if __name__ == "__main__":
    # æŒ‡å®šæ‚¨çš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # è¿™é‡Œç›´æ¥æŒ‡å®šè„šæœ¬è·¯å¾„

    # è¿è¡Œè„šæœ¬
    run_script(script_path)  # è°ƒç”¨å‡½æ•°è¿è¡ŒæŒ‡å®šçš„è„šæœ¬
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š

1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `sys`ï¼šç”¨äºè®¿é—®ä¸ Python è§£é‡Šå™¨ç´§å¯†ç›¸å…³çš„å˜é‡å’Œå‡½æ•°ã€‚
   - `subprocess`ï¼šç”¨äºåˆ›å»ºæ–°è¿›ç¨‹ã€è¿æ¥åˆ°å®ƒä»¬çš„è¾“å…¥/è¾“å‡º/é”™è¯¯ç®¡é“ï¼Œå¹¶è·å–å®ƒä»¬çš„è¿”å›ç ã€‚

2. **å®šä¹‰ `run_script` å‡½æ•°**ï¼š
   - è¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„ Python è„šæœ¬çš„è·¯å¾„ã€‚
   - ä½¿ç”¨ `sys.executable` è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œä»¥ç¡®ä¿ä½¿ç”¨ç›¸åŒçš„ç¯å¢ƒè¿è¡Œè„šæœ¬ã€‚
   - æ„å»ºå‘½ä»¤å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `streamlit` æ¨¡å—è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œæ„å»ºçš„å‘½ä»¤ï¼Œå¹¶æ£€æŸ¥è¿”å›ç ä»¥åˆ¤æ–­è„šæœ¬æ˜¯å¦æˆåŠŸè¿è¡Œã€‚

3. **ä¸»ç¨‹åºå—**ï¼š
   - ä½¿ç”¨ `if __name__ == "__main__":` ç¡®ä¿è¯¥ä»£ç å—ä»…åœ¨è„šæœ¬ä½œä¸ºä¸»ç¨‹åºè¿è¡Œæ—¶æ‰§è¡Œã€‚
   - æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆè¿™é‡Œä¸º `"web.py"`ï¼‰ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°ï¼Œä¼ å…¥è„šæœ¬è·¯å¾„ä»¥æ‰§è¡Œè¯¥è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ˜¯ä½¿ç”¨ Streamlit æ¡†æ¶æ¥å¯åŠ¨ä¸€ä¸ª Web åº”ç”¨ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œä»¥åŠä¸€ä¸ªè‡ªå®šä¹‰çš„è·¯å¾„å¤„ç†æ¨¡å— `abs_path`ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œé¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿åœ¨æ­£ç¡®çš„ç¯å¢ƒä¸­è¿è¡Œè„šæœ¬ã€‚æ¥ç€ï¼Œæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¯¥å‘½ä»¤ä½¿ç”¨å½“å‰çš„ Python è§£é‡Šå™¨å’Œ Streamlit æ¨¡å—æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚å‘½ä»¤çš„æ ¼å¼æ˜¯ `python -m streamlit run "script_path"`ï¼Œå…¶ä¸­ `script_path` æ˜¯ä¼ å…¥çš„å‚æ•°ã€‚

ä½¿ç”¨ `subprocess.run` æ–¹æ³•æ‰§è¡Œæ„å»ºå¥½çš„å‘½ä»¤ï¼Œå¹¶é€šè¿‡ `shell=True` å‚æ•°åœ¨ shell ä¸­è¿è¡Œå®ƒã€‚æ‰§è¡Œåï¼Œç¨‹åºä¼šæ£€æŸ¥è¿”å›çš„çŠ¶æ€ç ï¼Œå¦‚æœè¿”å›ç ä¸ä¸ºé›¶ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†é”™è¯¯ï¼Œç¨‹åºä¼šæ‰“å°å‡ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œä½¿ç”¨ `if __name__ == "__main__":` è¯­å¥æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥æ–‡ä»¶æ—¶æ‰ä¼šæ‰§è¡Œåé¢çš„ä»£ç ã€‚åœ¨è¿™é‡Œï¼ŒæŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ä¸º `web.py`ï¼Œå¹¶è°ƒç”¨ `run_script` å‡½æ•°æ¥å¯åŠ¨è¿™ä¸ªè„šæœ¬ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºçš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°å¯åŠ¨ä¸€ä¸ª Streamlit Web åº”ç”¨ï¼Œé€šè¿‡ç®€å•çš„å°è£…ä½¿å¾—ç”¨æˆ·å¯ä»¥ç›´æ¥è¿è¡ŒæŒ‡å®šçš„ Python è„šæœ¬ã€‚

#### 11.3 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\yolo\classify\predict.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import torch
from ultralytics.engine.predictor import BasePredictor
from ultralytics.engine.results import Results
from ultralytics.utils import DEFAULT_CFG, ops

class ClassificationPredictor(BasePredictor):
    """
    è¯¥ç±»æ‰©å±•äº† BasePredictor ç±»ï¼Œç”¨äºåŸºäºåˆ†ç±»æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚
    """

    def __init__(self, cfg=DEFAULT_CFG, overrides=None, _callbacks=None):
        """åˆå§‹åŒ– ClassificationPredictorï¼Œå°†ä»»åŠ¡è®¾ç½®ä¸º 'classify'ã€‚"""
        super().__init__(cfg, overrides, _callbacks)  # è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
        self.args.task = 'classify'  # è®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºåˆ†ç±»

    def preprocess(self, img):
        """å°†è¾“å…¥å›¾åƒè½¬æ¢ä¸ºæ¨¡å‹å…¼å®¹çš„æ•°æ®ç±»å‹ã€‚"""
        # å¦‚æœè¾“å…¥ä¸æ˜¯å¼ é‡ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºå¼ é‡
        if not isinstance(img, torch.Tensor):
            img = torch.stack([self.transforms(im) for im in img], dim=0)  # åº”ç”¨è½¬æ¢å¹¶å †å 
        # å°†å›¾åƒç§»åŠ¨åˆ°æ¨¡å‹æ‰€åœ¨çš„è®¾å¤‡ä¸Š
        img = (img if isinstance(img, torch.Tensor) else torch.from_numpy(img)).to(self.model.device)
        # æ ¹æ®æ¨¡å‹çš„ç²¾åº¦è®¾ç½®å°†å›¾åƒè½¬æ¢ä¸ºåŠç²¾åº¦æˆ–å•ç²¾åº¦æµ®ç‚¹æ•°
        return img.half() if self.model.fp16 else img.float()  # uint8 è½¬æ¢ä¸º fp16/32

    def postprocess(self, preds, img, orig_imgs):
        """å¯¹é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œè¿”å› Results å¯¹è±¡ã€‚"""
        # å¦‚æœåŸå§‹å›¾åƒä¸æ˜¯åˆ—è¡¨ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸º numpy æ•°ç»„
        if not isinstance(orig_imgs, list):
            orig_imgs = ops.convert_torch2numpy_batch(orig_imgs)

        results = []  # å­˜å‚¨ç»“æœçš„åˆ—è¡¨
        for i, pred in enumerate(preds):  # éå†æ¯ä¸ªé¢„æµ‹ç»“æœ
            orig_img = orig_imgs[i]  # è·å–å¯¹åº”çš„åŸå§‹å›¾åƒ
            img_path = self.batch[0][i]  # è·å–å›¾åƒè·¯å¾„
            # åˆ›å»º Results å¯¹è±¡å¹¶æ·»åŠ åˆ°ç»“æœåˆ—è¡¨ä¸­
            results.append(Results(orig_img, path=img_path, names=self.model.names, probs=pred))
        return results  # è¿”å›ç»“æœåˆ—è¡¨
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **å¯¼å…¥å¿…è¦çš„åº“**ï¼šå¼•å…¥ `torch` å’Œå…¶ä»–éœ€è¦çš„æ¨¡å—ã€‚
2. **ClassificationPredictor ç±»**ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºåˆ†ç±»ä»»åŠ¡çš„é¢„æµ‹å™¨ç±»ï¼Œç»§æ‰¿è‡ª `BasePredictor`ã€‚
3. **åˆå§‹åŒ–æ–¹æ³•**ï¼šåœ¨åˆå§‹åŒ–æ—¶è®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºåˆ†ç±»ï¼Œå¹¶è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚
4. **é¢„å¤„ç†æ–¹æ³•**ï¼šå°†è¾“å…¥å›¾åƒè½¬æ¢ä¸ºé€‚åˆæ¨¡å‹çš„æ ¼å¼ï¼Œæ”¯æŒå°†å›¾åƒä» numpy æ•°ç»„è½¬æ¢ä¸º PyTorch å¼ é‡ï¼Œå¹¶æ ¹æ®æ¨¡å‹çš„ç²¾åº¦è®¾ç½®è½¬æ¢æ•°æ®ç±»å‹ã€‚
5. **åå¤„ç†æ–¹æ³•**ï¼šå°†æ¨¡å‹çš„é¢„æµ‹ç»“æœè½¬æ¢ä¸º `Results` å¯¹è±¡ï¼Œä¾¿äºåç»­ä½¿ç”¨ã€‚è¿™é‡Œå¤„ç†äº†åŸå§‹å›¾åƒçš„æ ¼å¼è½¬æ¢ï¼Œå¹¶å°†æ¯ä¸ªé¢„æµ‹ç»“æœä¸å…¶å¯¹åº”çš„åŸå§‹å›¾åƒå’Œè·¯å¾„ä¸€èµ·å­˜å‚¨ã€‚

è¯¥ç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºYOLOv8åˆ†ç±»æ¨¡å‹é¢„æµ‹çš„Pythonè„šæœ¬ï¼Œå±äºUltralytics YOLOé¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º`ClassificationPredictor`çš„ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª`BasePredictor`ï¼Œç”¨äºå¤„ç†å›¾åƒåˆ†ç±»ä»»åŠ¡ã€‚

åœ¨ç±»çš„æ–‡æ¡£å­—ç¬¦ä¸²ä¸­ï¼Œè¯´æ˜äº†è¯¥ç±»çš„ç”¨é€”å’Œä½¿ç”¨ç¤ºä¾‹ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ä¼ é€’ä¸åŒçš„æ¨¡å‹å‚æ•°ï¼ˆä¾‹å¦‚`model='resnet18'`ï¼‰æ¥ä½¿ç”¨Torchvisionçš„åˆ†ç±»æ¨¡å‹ã€‚ç¤ºä¾‹ä»£ç å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ª`ClassificationPredictor`å®ä¾‹ï¼Œå¹¶è°ƒç”¨`predict_cli`æ–¹æ³•è¿›è¡Œé¢„æµ‹ã€‚

æ„é€ å‡½æ•°`__init__`åˆå§‹åŒ–äº†`ClassificationPredictor`ç±»ï¼Œå¹¶å°†ä»»åŠ¡ç±»å‹è®¾ç½®ä¸ºâ€œclassifyâ€ã€‚å®ƒè°ƒç”¨äº†çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¼ é€’äº†é…ç½®ã€è¦†ç›–å‚æ•°å’Œå›è°ƒå‡½æ•°ã€‚

`preprocess`æ–¹æ³•è´Ÿè´£å¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œä»¥ç¡®ä¿å…¶ç¬¦åˆæ¨¡å‹çš„è¾“å…¥è¦æ±‚ã€‚é¦–å…ˆï¼Œå®ƒæ£€æŸ¥è¾“å…¥æ˜¯å¦ä¸ºPyTorchå¼ é‡ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºå¼ é‡ã€‚æ¥ç€ï¼Œå›¾åƒä¼šè¢«ç§»åŠ¨åˆ°æ¨¡å‹æ‰€åœ¨çš„è®¾å¤‡ä¸Šï¼ˆå¦‚GPUï¼‰ï¼Œå¹¶æ ¹æ®æ¨¡å‹çš„ç²¾åº¦è®¾ç½®å°†æ•°æ®ç±»å‹è½¬æ¢ä¸ºåŠç²¾åº¦ï¼ˆfp16ï¼‰æˆ–å•ç²¾åº¦ï¼ˆfp32ï¼‰ã€‚

`postprocess`æ–¹æ³•ç”¨äºå¯¹æ¨¡å‹çš„é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œè¿”å›ä¸€ä¸ª`Results`å¯¹è±¡çš„åˆ—è¡¨ã€‚å®ƒé¦–å…ˆæ£€æŸ¥åŸå§‹å›¾åƒæ˜¯å¦ä¸ºåˆ—è¡¨ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºNumPyæ•°ç»„ã€‚ç„¶åï¼Œå¯¹äºæ¯ä¸ªé¢„æµ‹ç»“æœï¼Œæ–¹æ³•ä¼šæå–åŸå§‹å›¾åƒå’Œå¯¹åº”çš„å›¾åƒè·¯å¾„ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯ä¸é¢„æµ‹æ¦‚ç‡ä¸€èµ·å­˜å‚¨åœ¨`Results`å¯¹è±¡ä¸­ï¼Œæœ€ç»ˆè¿”å›è¿™äº›ç»“æœã€‚

æ•´ä½“è€Œè¨€ï¼Œè¯¥æ–‡ä»¶æä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨YOLOv8æ¨¡å‹è¿›è¡Œå›¾åƒåˆ†ç±»ï¼Œå¹¶å¯¹è¾“å…¥å’Œè¾“å‡ºè¿›è¡Œäº†å¿…è¦çš„å¤„ç†ï¼Œä»¥ç¡®ä¿æ¨¡å‹çš„æœ‰æ•ˆæ€§å’Œå‡†ç¡®æ€§ã€‚

#### 11.4 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\solutions\ai_gym.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import cv2
from ultralytics.utils.plotting import Annotator

class AIGym:
    """ç®¡ç†å®æ—¶è§†é¢‘æµä¸­äººä»¬çš„å¥èº«åŠ¨ä½œè®¡æ•°çš„ç±»ã€‚"""

    def __init__(self):
        """åˆå§‹åŒ–AIGymç±»çš„é»˜è®¤å‚æ•°ã€‚"""
        self.im0 = None  # å½“å‰å¸§å›¾åƒ
        self.tf = None   # çº¿æ¡åšåº¦
        self.keypoints = None  # å…³é”®ç‚¹æ•°æ®
        self.poseup_angle = None  # ä¸Šå‡å§¿åŠ¿è§’åº¦
        self.posedown_angle = None  # ä¸‹é™å§¿åŠ¿è§’åº¦
        self.threshold = 0.001  # é˜ˆå€¼
        self.angle = None  # å§¿åŠ¿è§’åº¦
        self.count = None  # åŠ¨ä½œè®¡æ•°
        self.stage = None  # å½“å‰é˜¶æ®µ
        self.pose_type = 'pushup'  # å§¿åŠ¿ç±»å‹ï¼ˆå¦‚ä¿¯å§æ’‘ï¼‰
        self.kpts_to_check = None  # éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹
        self.view_img = False  # æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
        self.annotator = None  # æ³¨é‡Šå·¥å…·

    def set_args(self, kpts_to_check, line_thickness=2, view_img=False, pose_up_angle=145.0, pose_down_angle=90.0, pose_type='pullup'):
        """
        é…ç½®AIGymçš„å‚æ•°ã€‚
        Args:
            kpts_to_check (list): ç”¨äºè®¡æ•°çš„3ä¸ªå…³é”®ç‚¹
            line_thickness (int): è¾¹æ¡†çº¿æ¡çš„åšåº¦
            view_img (bool): æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
            pose_up_angle (float): ä¸Šå‡å§¿åŠ¿çš„è§’åº¦
            pose_down_angle (float): ä¸‹é™å§¿åŠ¿çš„è§’åº¦
            pose_type: "pushup", "pullup" æˆ– "abworkout"
        """
        self.kpts_to_check = kpts_to_check
        self.tf = line_thickness
        self.view_img = view_img
        self.poseup_angle = pose_up_angle
        self.posedown_angle = pose_down_angle
        self.pose_type = pose_type

    def start_counting(self, im0, results, frame_count):
        """
        è®¡æ•°å¥èº«åŠ¨ä½œçš„å‡½æ•°ã€‚
        Args:
            im0 (ndarray): å½“å‰è§†é¢‘å¸§
            results: å§¿åŠ¿ä¼°è®¡æ•°æ®
            frame_count: å½“å‰å¸§è®¡æ•°
        """
        self.im0 = im0  # ä¿å­˜å½“å‰å¸§
        if frame_count == 1:
            # åˆå§‹åŒ–è®¡æ•°å’Œè§’åº¦
            self.count = [0] * len(results[0])
            self.angle = [0] * len(results[0])
            self.stage = ['-' for _ in results[0]]
        
        self.keypoints = results[0].keypoints.data  # è·å–å…³é”®ç‚¹æ•°æ®
        self.annotator = Annotator(im0, line_width=2)  # åˆå§‹åŒ–æ³¨é‡Šå·¥å…·

        # éå†æ¯ä¸ªå…³é”®ç‚¹
        for ind, k in enumerate(reversed(self.keypoints)):
            # è®¡ç®—å§¿åŠ¿è§’åº¦
            self.angle[ind] = self.annotator.estimate_pose_angle(
                k[int(self.kpts_to_check[0])].cpu(),
                k[int(self.kpts_to_check[1])].cpu(),
                k[int(self.kpts_to_check[2])].cpu()
            )
            self.im0 = self.annotator.draw_specific_points(k, self.kpts_to_check, shape=(640, 640), radius=10)

            # æ ¹æ®å§¿åŠ¿ç±»å‹æ›´æ–°è®¡æ•°å’Œé˜¶æ®µ
            if self.pose_type == 'pushup':
                self.update_count_pushup(ind)
            elif self.pose_type == 'pullup':
                self.update_count_pullup(ind)
            elif self.pose_type == 'abworkout':
                self.update_count_abworkout(ind)

            # ç»˜åˆ¶å…³é”®ç‚¹
            self.annotator.kpts(k, shape=(640, 640), radius=1, kpt_line=True)

        # å¦‚æœéœ€è¦æ˜¾ç¤ºå›¾åƒ
        if self.view_img:
            cv2.imshow('Ultralytics YOLOv8 AI GYM', self.im0)
            if cv2.waitKey(1) & 0xFF == ord('q'):
                return

    def update_count_pushup(self, ind):
        """æ›´æ–°ä¿¯å§æ’‘çš„è®¡æ•°å’Œé˜¶æ®µ"""
        if self.angle[ind] > self.poseup_angle:
            self.stage[ind] = 'up'
        if self.angle[ind] < self.posedown_angle and self.stage[ind] == 'up':
            self.stage[ind] = 'down'
            self.count[ind] += 1
        self.annotator.plot_angle_and_count_and_stage(
            angle_text=self.angle[ind],
            count_text=self.count[ind],
            stage_text=self.stage[ind],
            center_kpt=self.keypoints[ind][int(self.kpts_to_check[1])],
            line_thickness=self.tf
        )

    def update_count_pullup(self, ind):
        """æ›´æ–°å¼•ä½“å‘ä¸Šçš„è®¡æ•°å’Œé˜¶æ®µ"""
        if self.angle[ind] > self.poseup_angle:
            self.stage[ind] = 'down'
        if self.angle[ind] < self.posedown_angle and self.stage[ind] == 'down':
            self.stage[ind] = 'up'
            self.count[ind] += 1
        self.annotator.plot_angle_and_count_and_stage(
            angle_text=self.angle[ind],
            count_text=self.count[ind],
            stage_text=self.stage[ind],
            center_kpt=self.keypoints[ind][int(self.kpts_to_check[1])],
            line_thickness=self.tf
        )

    def update_count_abworkout(self, ind):
        """æ›´æ–°è…¹éƒ¨é”»ç‚¼çš„è®¡æ•°å’Œé˜¶æ®µ"""
        if self.angle[ind] > self.poseup_angle:
            self.stage[ind] = 'down'
        if self.angle[ind] < self.posedown_angle and self.stage[ind] == 'down':
            self.stage[ind] = 'up'
            self.count[ind] += 1
        self.annotator.plot_angle_and_count_and_stage(
            angle_text=self.angle[ind],
            count_text=self.count[ind],
            stage_text=self.stage[ind],
            center_kpt=self.keypoints[ind][int(self.kpts_to_check[1])],
            line_thickness=self.tf
        )

if __name__ == '__main__':
    AIGym()  # å®ä¾‹åŒ–AIGymç±»
```

### ä»£ç è¯´æ˜ï¼š
1. **ç±»çš„åˆå§‹åŒ–**ï¼š`__init__`æ–¹æ³•ä¸­å®šä¹‰äº†ç±»çš„åŸºæœ¬å±æ€§ï¼ŒåŒ…æ‹¬å›¾åƒã€å…³é”®ç‚¹ã€è®¡æ•°å’Œé˜¶æ®µç­‰ã€‚
2. **å‚æ•°è®¾ç½®**ï¼š`set_args`æ–¹æ³•ç”¨äºé…ç½®å¥èº«åŠ¨ä½œçš„ç›¸å…³å‚æ•°ï¼Œä¾‹å¦‚éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹ã€çº¿æ¡åšåº¦å’Œå§¿åŠ¿ç±»å‹ç­‰ã€‚
3. **è®¡æ•°é€»è¾‘**ï¼š`start_counting`æ–¹æ³•æ˜¯æ ¸å¿ƒåŠŸèƒ½ï¼Œç”¨äºæ ¹æ®å§¿åŠ¿ä¼°è®¡ç»“æœå®æ—¶æ›´æ–°å¥èº«åŠ¨ä½œçš„è®¡æ•°å’Œé˜¶æ®µã€‚
4. **æ›´æ–°è®¡æ•°**ï¼šæ ¹æ®ä¸åŒçš„å§¿åŠ¿ç±»å‹ï¼ˆä¿¯å§æ’‘ã€å¼•ä½“å‘ä¸Šã€è…¹éƒ¨é”»ç‚¼ï¼‰ï¼Œåˆ†åˆ«åœ¨`update_count_pushup`ã€`update_count_pullup`å’Œ`update_count_abworkout`æ–¹æ³•ä¸­æ›´æ–°è®¡æ•°å’Œé˜¶æ®µã€‚
5. **å›¾åƒæ˜¾ç¤º**ï¼šå¦‚æœè®¾ç½®äº†æ˜¾ç¤ºå›¾åƒï¼Œåˆ™ä½¿ç”¨OpenCVæ˜¾ç¤ºå½“å‰å¸§ï¼Œå¹¶åœ¨æŒ‰ä¸‹'q'é”®æ—¶é€€å‡ºã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `AIGym` çš„ç±»ï¼Œä¸»è¦ç”¨äºåœ¨å®æ—¶è§†é¢‘æµä¸­åŸºäºäººä½“å§¿æ€æ¥ç®¡ç†å¥èº«åŠ¨ä½œçš„è®¡æ•°ã€‚ä»£ç çš„ç»“æ„æ¸…æ™°ï¼ŒåŠŸèƒ½ä¸»è¦é›†ä¸­åœ¨å¯¹ä¸åŒå¥èº«åŠ¨ä½œï¼ˆå¦‚ä¿¯å§æ’‘ã€å¼•ä½“å‘ä¸Šå’Œè…¹éƒ¨é”»ç‚¼ï¼‰çš„æ£€æµ‹å’Œè®¡æ•°ä¸Šã€‚

åœ¨ç±»çš„åˆå§‹åŒ–æ–¹æ³• `__init__` ä¸­ï¼Œè®¾ç½®äº†ä¸€äº›é»˜è®¤å€¼ï¼ŒåŒ…æ‹¬å›¾åƒå‚æ•°ã€å…³é”®ç‚¹ä¿¡æ¯ã€è§’åº¦é˜ˆå€¼ç­‰ã€‚è¿™é‡Œçš„ `im0` ç”¨äºå­˜å‚¨å½“å‰å¸§å›¾åƒï¼Œ`tf` è¡¨ç¤ºçº¿æ¡çš„åšåº¦ï¼Œ`keypoints` ç”¨äºå­˜å‚¨å…³é”®ç‚¹æ•°æ®ï¼Œ`poseup_angle` å’Œ `posedown_angle` åˆ†åˆ«å®šä¹‰äº†å§¿åŠ¿çš„ä¸Šé™å’Œä¸‹é™è§’åº¦ï¼Œ`pose_type` ç”¨äºæŒ‡å®šå½“å‰çš„å¥èº«åŠ¨ä½œç±»å‹ã€‚

`set_args` æ–¹æ³•ç”¨äºé…ç½®ä¸€äº›å‚æ•°ï¼ŒåŒ…æ‹¬éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹ã€çº¿æ¡åšåº¦ã€æ˜¯å¦æ˜¾ç¤ºå›¾åƒã€ä¸Šå‡å’Œä¸‹é™çš„è§’åº¦é˜ˆå€¼ä»¥åŠå¥èº«åŠ¨ä½œç±»å‹ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ç”¨æˆ·æ ¹æ®éœ€è¦è‡ªå®šä¹‰è¿™äº›å‚æ•°ã€‚

`start_counting` æ–¹æ³•æ˜¯ä¸»è¦çš„è®¡æ•°é€»è¾‘ï¼Œæ¥æ”¶å½“å‰å¸§å›¾åƒã€å§¿æ€ä¼°è®¡ç»“æœå’Œå¸§è®¡æ•°ä½œä¸ºè¾“å…¥ã€‚é¦–å…ˆï¼Œå®ƒä¼šåœ¨ç¬¬ä¸€å¸§æ—¶åˆå§‹åŒ–è®¡æ•°å’Œè§’åº¦åˆ—è¡¨ã€‚ç„¶åï¼Œé€šè¿‡éå†å…³é”®ç‚¹ï¼Œè®¡ç®—å‡ºæ¯ä¸ªå…³é”®ç‚¹çš„å§¿æ€è§’åº¦ï¼Œå¹¶æ ¹æ®è®¾å®šçš„å¥èº«åŠ¨ä½œç±»å‹æ¥åˆ¤æ–­å½“å‰çš„å§¿åŠ¿çŠ¶æ€ï¼ˆå¦‚â€œä¸Šâ€æˆ–â€œä¸‹â€ï¼‰ã€‚æ ¹æ®å§¿åŠ¿çš„å˜åŒ–ï¼Œæ›´æ–°è®¡æ•°å’ŒçŠ¶æ€ï¼Œå¹¶åœ¨å›¾åƒä¸Šç»˜åˆ¶ç›¸å…³ä¿¡æ¯ï¼ˆå¦‚è§’åº¦ã€è®¡æ•°å’ŒçŠ¶æ€ï¼‰ã€‚

åœ¨ä¸åŒçš„å¥èº«åŠ¨ä½œç±»å‹ä¸­ï¼Œç¨‹åºä¼šæ ¹æ®å§¿æ€è§’åº¦çš„å˜åŒ–æ¥åˆ¤æ–­åŠ¨ä½œçš„å®Œæˆæƒ…å†µã€‚ä¾‹å¦‚ï¼Œåœ¨ä¿¯å§æ’‘ä¸­ï¼Œå½“è§’åº¦å¤§äºä¸Šé™è§’åº¦æ—¶ï¼ŒçŠ¶æ€ä¸ºâ€œä¸Šâ€ï¼›å½“è§’åº¦å°äºä¸‹é™è§’åº¦ä¸”çŠ¶æ€ä¸ºâ€œä¸Šâ€æ—¶ï¼ŒçŠ¶æ€å˜ä¸ºâ€œä¸‹â€ï¼Œå¹¶å¢åŠ è®¡æ•°ã€‚å¼•ä½“å‘ä¸Šå’Œè…¹éƒ¨é”»ç‚¼çš„é€»è¾‘ç±»ä¼¼ï¼Œä½†å…·ä½“çš„è§’åº¦é˜ˆå€¼å’ŒçŠ¶æ€åˆ¤æ–­å¯èƒ½æœ‰æ‰€ä¸åŒã€‚

æœ€åï¼Œå¦‚æœè®¾ç½®äº† `view_img` ä¸ºçœŸï¼Œç¨‹åºä¼šä½¿ç”¨ OpenCV æ˜¾ç¤ºå½“å‰å¸§å›¾åƒï¼Œå¹¶å…è®¸ç”¨æˆ·é€šè¿‡æŒ‰ä¸‹ 'q' é”®é€€å‡ºæ˜¾ç¤ºã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™æ®µä»£ç é€šè¿‡ç»“åˆå§¿æ€ä¼°è®¡å’Œå›¾åƒå¤„ç†æŠ€æœ¯ï¼Œå®ç°äº†ä¸€ä¸ªç®€å•çš„å¥èº«åŠ¨ä½œè®¡æ•°å™¨ï¼Œèƒ½å¤Ÿå®æ—¶ç›‘æµ‹ç”¨æˆ·çš„å¥èº«åŠ¨ä½œå¹¶æä¾›åé¦ˆã€‚

#### 11.5 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\extra_modules\RFAConv.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import torch
import torch.nn as nn
from einops import rearrange

class h_sigmoid(nn.Module):
    """å®ç°h-sigmoidæ¿€æ´»å‡½æ•°"""
    def __init__(self, inplace=True):
        super(h_sigmoid, self).__init__()
        self.relu = nn.ReLU6(inplace=inplace)

    def forward(self, x):
        return self.relu(x + 3) / 6  # è®¡ç®—h-sigmoid

class h_swish(nn.Module):
    """å®ç°h-swishæ¿€æ´»å‡½æ•°"""
    def __init__(self, inplace=True):
        super(h_swish, self).__init__()
        self.sigmoid = h_sigmoid(inplace=inplace)

    def forward(self, x):
        return x * self.sigmoid(x)  # è®¡ç®—h-swish

class RFAConv(nn.Module):
    """RFAå·ç§¯æ¨¡å—"""
    def __init__(self, in_channel, out_channel, kernel_size, stride=1):
        super().__init__()
        self.kernel_size = kernel_size

        # æƒé‡ç”Ÿæˆç½‘ç»œ
        self.get_weight = nn.Sequential(
            nn.AvgPool2d(kernel_size=kernel_size, padding=kernel_size // 2, stride=stride),
            nn.Conv2d(in_channel, in_channel * (kernel_size ** 2), kernel_size=1, groups=in_channel, bias=False)
        )
        
        # ç‰¹å¾ç”Ÿæˆç½‘ç»œ
        self.generate_feature = nn.Sequential(
            nn.Conv2d(in_channel, in_channel * (kernel_size ** 2), kernel_size=kernel_size, padding=kernel_size // 2, stride=stride, groups=in_channel, bias=False),
            nn.BatchNorm2d(in_channel * (kernel_size ** 2)),
            nn.ReLU()
        )
        
        # æœ€ç»ˆå·ç§¯å±‚
        self.conv = nn.Conv2d(in_channel, out_channel, kernel_size=kernel_size, stride=kernel_size)

    def forward(self, x):
        b, c = x.shape[0:2]  # è·å–æ‰¹æ¬¡å¤§å°å’Œé€šé“æ•°
        weight = self.get_weight(x)  # ç”Ÿæˆæƒé‡
        h, w = weight.shape[2:]  # è·å–ç‰¹å¾å›¾çš„é«˜å’Œå®½
        
        # è®¡ç®—æƒé‡å¹¶è¿›è¡Œsoftmaxå½’ä¸€åŒ–
        weighted = weight.view(b, c, self.kernel_size ** 2, h, w).softmax(2)
        feature = self.generate_feature(x).view(b, c, self.kernel_size ** 2, h, w)  # ç”Ÿæˆç‰¹å¾
        
        # åŠ æƒç‰¹å¾
        weighted_data = feature * weighted
        conv_data = rearrange(weighted_data, 'b c (n1 n2) h w -> b c (h n1) (w n2)', n1=self.kernel_size, n2=self.kernel_size)
        
        return self.conv(conv_data)  # è¿”å›å·ç§¯ç»“æœ

class SE(nn.Module):
    """Squeeze-and-Excitationæ¨¡å—"""
    def __init__(self, in_channel, ratio=16):
        super(SE, self).__init__()
        self.gap = nn.AdaptiveAvgPool2d((1, 1))  # å…¨å±€å¹³å‡æ± åŒ–
        self.fc = nn.Sequential(
            nn.Linear(in_channel, ratio, bias=False),  # ä»cåˆ°c/r
            nn.ReLU(),
            nn.Linear(ratio, in_channel, bias=False),  # ä»c/råˆ°c
            nn.Sigmoid()
        )

    def forward(self, x):
        b, c = x.shape[0:2]
        y = self.gap(x).view(b, c)  # è®¡ç®—å…¨å±€ç‰¹å¾
        y = self.fc(y).view(b, c, 1, 1)  # é€šè¿‡å…¨è¿æ¥å±‚
        return y  # è¿”å›é€šé“æ³¨æ„åŠ›

class RFCBAMConv(nn.Module):
    """RFCBAMå·ç§¯æ¨¡å—"""
    def __init__(self, in_channel, out_channel, kernel_size=3, stride=1):
        super().__init__()
        self.kernel_size = kernel_size
        
        # ç‰¹å¾ç”Ÿæˆç½‘ç»œ
        self.generate = nn.Sequential(
            nn.Conv2d(in_channel, in_channel * (kernel_size ** 2), kernel_size, padding=kernel_size // 2, stride=stride, groups=in_channel, bias=False),
            nn.BatchNorm2d(in_channel * (kernel_size ** 2)),
            nn.ReLU()
        )
        
        # æƒé‡ç”Ÿæˆç½‘ç»œ
        self.get_weight = nn.Sequential(nn.Conv2d(2, 1, kernel_size=3, padding=1, bias=False), nn.Sigmoid())
        self.se = SE(in_channel)  # å¼•å…¥SEæ¨¡å—

        # æœ€ç»ˆå·ç§¯å±‚
        self.conv = nn.Conv2d(in_channel, out_channel, kernel_size=kernel_size, stride=kernel_size)

    def forward(self, x):
        b, c = x.shape[0:2]
        channel_attention = self.se(x)  # è®¡ç®—é€šé“æ³¨æ„åŠ›
        generate_feature = self.generate(x)  # ç”Ÿæˆç‰¹å¾

        h, w = generate_feature.shape[2:]
        generate_feature = generate_feature.view(b, c, self.kernel_size ** 2, h, w)  # å˜å½¢
        
        # ç‰¹å¾é‡æ’åˆ—
        generate_feature = rearrange(generate_feature, 'b c (n1 n2) h w -> b c (h n1) (w n2)', n1=self.kernel_size, n2=self.kernel_size)
        
        # åŠ æƒç‰¹å¾
        unfold_feature = generate_feature * channel_attention
        max_feature, _ = torch.max(generate_feature, dim=1, keepdim=True)  # æœ€å¤§ç‰¹å¾
        mean_feature = torch.mean(generate_feature, dim=1, keepdim=True)  # å¹³å‡ç‰¹å¾
        
        # è®¡ç®—æ¥æ”¶åœºæ³¨æ„åŠ›
        receptive_field_attention = self.get_weight(torch.cat((max_feature, mean_feature), dim=1))
        conv_data = unfold_feature * receptive_field_attention  # åŠ æƒç‰¹å¾
        
        return self.conv(conv_data)  # è¿”å›å·ç§¯ç»“æœ
```

### ä»£ç è¯´æ˜ï¼š
1. **h_sigmoid å’Œ h_swish**ï¼šå®ç°äº†h-sigmoidå’Œh-swishæ¿€æ´»å‡½æ•°ï¼Œåˆ†åˆ«ç”¨äºæ¿€æ´»ç¥ç»ç½‘ç»œä¸­çš„ç‰¹å¾ã€‚
2. **RFAConv**ï¼šå®ç°äº†ä¸€ä¸ªåŸºäºåŠ æƒç‰¹å¾çš„å·ç§¯æ¨¡å—ï¼Œé¦–å…ˆç”Ÿæˆç‰¹å¾ï¼Œç„¶åé€šè¿‡æƒé‡è¿›è¡ŒåŠ æƒï¼Œæœ€åé€šè¿‡å·ç§¯å±‚è¾“å‡ºç»“æœã€‚
3. **SE**ï¼šå®ç°äº†Squeeze-and-Excitationæ¨¡å—ï¼Œç”¨äºè®¡ç®—é€šé“æ³¨æ„åŠ›ï¼Œå¢å¼ºé‡è¦ç‰¹å¾çš„è¡¨è¾¾ã€‚
4. **RFCBAMConv**ï¼šç»“åˆäº†ç‰¹å¾ç”Ÿæˆã€é€šé“æ³¨æ„åŠ›å’Œæ¥æ”¶åœºæ³¨æ„åŠ›çš„å·ç§¯æ¨¡å—ï¼Œæ—¨åœ¨æé«˜ç‰¹å¾æå–çš„æ•ˆæœã€‚

ä»¥ä¸Šä»£ç æ˜¯å®ç°æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸­é‡è¦çš„å·ç§¯æ¨¡å—ï¼Œé€‚ç”¨äºå›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€äº›ç”¨äºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„å·ç§¯æ¨¡å—ï¼Œä¸»è¦æ˜¯é’ˆå¯¹YOLOv8ç®—æ³•çš„æ”¹è¿›ã€‚æ–‡ä»¶ä¸­åŒ…å«äº†å‡ ä¸ªç±»ï¼Œåˆ†åˆ«æ˜¯`h_sigmoid`ã€`h_swish`ã€`RFAConv`ã€`RFCBAMConv`å’Œ`RFCAConv`ï¼Œæ¯ä¸ªç±»éƒ½æœ‰å…¶ç‰¹å®šçš„åŠŸèƒ½å’Œç»“æ„ã€‚

é¦–å…ˆï¼Œ`h_sigmoid`å’Œ`h_swish`æ˜¯è‡ªå®šä¹‰çš„æ¿€æ´»å‡½æ•°ã€‚`h_sigmoid`æ˜¯ä¸€ä¸ªé«˜é˜¶çš„sigmoidå‡½æ•°ï¼Œå®ƒé€šè¿‡ReLU6å‡½æ•°è¿›è¡Œå¤„ç†ï¼Œä½¿å¾—è¾“å‡ºåœ¨0åˆ°1ä¹‹é—´ã€‚`h_swish`åˆ™ç»“åˆäº†`h_sigmoid`å’Œè¾“å…¥å€¼ï¼Œå½¢æˆäº†ä¸€ä¸ªæ–°çš„æ¿€æ´»å‡½æ•°ï¼Œèƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜æ¨¡å‹çš„è¡¨ç°ã€‚

æ¥ä¸‹æ¥æ˜¯`RFAConv`ç±»ï¼Œå®ƒå®ç°äº†ä¸€ç§æ–°çš„å·ç§¯æ“ä½œã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°ä¸­å®šä¹‰äº†å‡ ä¸ªå­æ¨¡å—ï¼ŒåŒ…æ‹¬ç”¨äºç”Ÿæˆæƒé‡çš„å¹³å‡æ± åŒ–å’Œå·ç§¯å±‚ï¼Œä»¥åŠç”¨äºç”Ÿæˆç‰¹å¾çš„å·ç§¯å±‚å’Œæ‰¹å½’ä¸€åŒ–å±‚ã€‚åœ¨å‰å‘ä¼ æ’­ä¸­ï¼Œè¾“å…¥æ•°æ®é¦–å…ˆé€šè¿‡è¿™äº›å­æ¨¡å—ç”Ÿæˆæƒé‡å’Œç‰¹å¾ï¼Œç„¶åè¿›è¡ŒåŠ æƒæ“ä½œï¼Œæœ€åé€šè¿‡å·ç§¯å±‚è¾“å‡ºç»“æœã€‚è¿™ç§è®¾è®¡å¯ä»¥å¢å¼ºæ¨¡å‹å¯¹ç‰¹å¾çš„å­¦ä¹ èƒ½åŠ›ã€‚

`RFCBAMConv`ç±»æ˜¯å¦ä¸€ä¸ªå·ç§¯æ¨¡å—ï¼Œå®ƒç»“åˆäº†é€šé“æ³¨æ„åŠ›æœºåˆ¶ã€‚æ„é€ å‡½æ•°ä¸­å®šä¹‰äº†ç”Ÿæˆç‰¹å¾çš„å·ç§¯å±‚ã€é€šé“æ³¨æ„åŠ›çš„è®¡ç®—å±‚ä»¥åŠæœ€ç»ˆçš„å·ç§¯å±‚ã€‚åœ¨å‰å‘ä¼ æ’­ä¸­ï¼Œè¾“å…¥æ•°æ®ç»è¿‡ç‰¹å¾ç”Ÿæˆå’Œé€šé“æ³¨æ„åŠ›çš„å¤„ç†ï¼Œæœ€åé€šè¿‡å·ç§¯å±‚è¾“å‡ºç»“æœã€‚è¿™ç§è®¾è®¡å¯ä»¥å¸®åŠ©æ¨¡å‹æ›´å¥½åœ°å…³æ³¨é‡è¦çš„ç‰¹å¾ã€‚

æœ€åï¼Œ`RFCAConv`ç±»æ˜¯ä¸€ä¸ªç»“åˆäº†ç©ºé—´æ³¨æ„åŠ›æœºåˆ¶çš„å·ç§¯æ¨¡å—ã€‚å®ƒçš„æ„é€ å‡½æ•°ä¸­å®šä¹‰äº†ç‰¹å¾ç”Ÿæˆå±‚ã€å…¨å±€å¹³å‡æ± åŒ–å±‚å’Œå¤šä¸ªå·ç§¯å±‚ã€‚åœ¨å‰å‘ä¼ æ’­ä¸­ï¼Œè¾“å…¥æ•°æ®ç»è¿‡ç‰¹å¾ç”Ÿæˆã€ç©ºé—´æ³¨æ„åŠ›è®¡ç®—å’Œæœ€ç»ˆå·ç§¯æ“ä½œï¼Œè¾“å‡ºç»“æœã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ¨¡å‹èƒ½å¤Ÿåœ¨ç©ºé—´ç»´åº¦ä¸Šè‡ªé€‚åº”åœ°è°ƒæ•´ç‰¹å¾çš„æƒé‡ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº†ä¸€äº›å…ˆè¿›çš„å·ç§¯æ“ä½œå’Œæ³¨æ„åŠ›æœºåˆ¶ï¼Œæ—¨åœ¨æå‡YOLOv8ç®—æ³•åœ¨ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­çš„æ€§èƒ½ã€‚æ¯ä¸ªæ¨¡å—çš„è®¾è®¡éƒ½è€ƒè™‘åˆ°äº†ç‰¹å¾çš„ç”Ÿæˆã€åŠ æƒå’Œæœ€ç»ˆçš„å·ç§¯æ“ä½œï¼Œä»¥å®ç°æ›´å¥½çš„ç‰¹å¾æå–å’Œè¡¨ç¤ºèƒ½åŠ›ã€‚

#### 11.6 train.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class DetectionTrainer(BaseTrainer):
    """
    DetectionTrainerç±»æ‰©å±•äº†BaseTrainerç±»ï¼Œç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹çš„è®­ç»ƒã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æ„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œ`train`è¡¨ç¤ºè®­ç»ƒæ¨¡å¼ï¼Œ`val`è¡¨ç¤ºéªŒè¯æ¨¡å¼ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„å¢å¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…ç”¨äº`rect`æ¨¡å¼ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)  # è·å–æ¨¡å‹çš„æœ€å¤§æ­¥å¹…
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æ„é€ å¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼ä¸ºè®­ç»ƒæˆ–éªŒè¯
        with torch_distributed_zero_first(rank):  # å¦‚æœä½¿ç”¨åˆ†å¸ƒå¼æ•°æ®å¹¶è¡Œï¼Œç¡®ä¿åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†
            dataset = self.build_dataset(dataset_path, mode, batch_size)  # æ„å»ºæ•°æ®é›†
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        if getattr(dataset, "rect", False) and shuffle:
            LOGGER.warning("WARNING âš ï¸ 'rect=True'ä¸DataLoaderçš„shuffleä¸å…¼å®¹ï¼Œè®¾ç½®shuffle=False")
            shuffle = False  # å¦‚æœä½¿ç”¨rectæ¨¡å¼ï¼Œåˆ™ä¸æ‰“ä¹±æ•°æ®
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # æ ¹æ®æ¨¡å¼è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æœå¯ç”¨å¤šå°ºåº¦è®­ç»ƒ
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©ä¸€ä¸ªæ–°çš„å°ºå¯¸
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼ç¼©æ”¾
            batch["img"] = imgs  # æ›´æ–°æ‰¹æ¬¡ä¸­çš„å›¾åƒ
        return batch

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›YOLOæ£€æµ‹æ¨¡å‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡å‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def get_validator(self):
        """è¿”å›ç”¨äºYOLOæ¨¡å‹éªŒè¯çš„DetectionValidatorã€‚"""
        self.loss_names = "box_loss", "cls_loss", "dfl_loss"  # å®šä¹‰æŸå¤±åç§°
        return yolo.detect.DetectionValidator(
            self.test_loader, save_dir=self.save_dir, args=copy(self.args), _callbacks=self.callbacks
        )  # è¿”å›éªŒè¯å™¨

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )  # ç»˜åˆ¶å›¾åƒå¹¶ä¿å­˜

    def plot_metrics(self):
        """ä»CSVæ–‡ä»¶ä¸­ç»˜åˆ¶æŒ‡æ ‡ã€‚"""
        plot_results(file=self.csv, on_plot=self.on_plot)  # ä¿å­˜ç»“æœå›¾åƒ
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **DetectionTrainerç±»**ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒYOLOæ£€æµ‹æ¨¡å‹çš„ç±»ï¼Œç»§æ‰¿è‡ªBaseTrainerã€‚
2. **build_datasetæ–¹æ³•**ï¼šæ„å»ºYOLOæ•°æ®é›†ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ã€‚
3. **get_dataloaderæ–¹æ³•**ï¼šåˆ›å»ºæ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒå¤šçº¿ç¨‹å’Œæ•°æ®æ‰“ä¹±ã€‚
4. **preprocess_batchæ–¹æ³•**ï¼šå¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œç¼©æ”¾ã€‚
5. **get_modelæ–¹æ³•**ï¼šè¿”å›YOLOæ£€æµ‹æ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
6. **get_validatoræ–¹æ³•**ï¼šè¿”å›ç”¨äºæ¨¡å‹éªŒè¯çš„éªŒè¯å™¨ã€‚
7. **plot_training_sampleså’Œplot_metricsæ–¹æ³•**ï¼šç”¨äºå¯è§†åŒ–è®­ç»ƒæ ·æœ¬å’Œç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒ YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„è„šæœ¬ï¼Œç»§æ‰¿è‡ª `BaseTrainer` ç±»ã€‚ç¨‹åºçš„ä¸»è¦åŠŸèƒ½æ˜¯æ„å»ºæ•°æ®é›†ã€åˆ›å»ºæ•°æ®åŠ è½½å™¨ã€é¢„å¤„ç†å›¾åƒã€è®¾ç½®æ¨¡å‹å±æ€§ã€è·å–æ¨¡å‹ã€éªŒè¯æ¨¡å‹ã€è®°å½•æŸå¤±ã€ç»˜åˆ¶è®­ç»ƒæ ·æœ¬å’Œç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ç­‰ã€‚

é¦–å…ˆï¼Œç¨‹åºå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬æ•°å­¦è®¡ç®—ã€éšæœºæ•°ç”Ÿæˆã€æ·±åº¦å­¦ä¹ ç›¸å…³çš„ PyTorch æ¨¡å—ï¼Œä»¥åŠ Ultralytics æä¾›çš„ç”¨äºæ„å»ºæ•°æ®é›†å’Œæ¨¡å‹çš„å·¥å…·ã€‚æ¥ç€ï¼Œå®šä¹‰äº† `DetectionTrainer` ç±»ï¼Œè¯¥ç±»ä¸“é—¨ç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹çš„è®­ç»ƒã€‚

åœ¨ `DetectionTrainer` ç±»ä¸­ï¼Œ`build_dataset` æ–¹æ³•ç”¨äºæ„å»º YOLO æ•°æ®é›†ï¼Œæ¥æ”¶å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹é‡å¤§å°ä½œä¸ºå‚æ•°ã€‚å®ƒä¼šæ ¹æ®æ¨¡å‹çš„æ­¥å¹…è®¡ç®—å‡ºåˆé€‚çš„å›¾åƒå°ºå¯¸ï¼Œå¹¶è°ƒç”¨ `build_yolo_dataset` å‡½æ•°æ¥åˆ›å»ºæ•°æ®é›†ã€‚

`get_dataloader` æ–¹æ³•åˆ™ç”¨äºæ„å»ºæ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒæ—¶åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ï¼Œå¹¶æ ¹æ®æ¨¡å¼é€‰æ‹©æ˜¯å¦æ‰“ä¹±æ•°æ®ã€‚å®ƒè¿˜ä¼šæ ¹æ®æ¨¡å¼è®¾ç½®å·¥ä½œçº¿ç¨‹çš„æ•°é‡ï¼Œå¹¶è¿”å›æ„å»ºå¥½çš„æ•°æ®åŠ è½½å™¨ã€‚

`preprocess_batch` æ–¹æ³•è´Ÿè´£å¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒç¼©æ”¾åˆ°é€‚å½“çš„å¤§å°å¹¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°æ ¼å¼ã€‚å®ƒæ”¯æŒå¤šå°ºåº¦è®­ç»ƒï¼Œé€šè¿‡éšæœºé€‰æ‹©å›¾åƒå¤§å°æ¥å¢å¼ºæ¨¡å‹çš„é²æ£’æ€§ã€‚

`set_model_attributes` æ–¹æ³•ç”¨äºè®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ç­‰ã€‚è¿™äº›å±æ€§æ˜¯æ ¹æ®æ•°æ®é›†çš„ä¿¡æ¯è¿›è¡Œé…ç½®çš„ã€‚

`get_model` æ–¹æ³•è¿”å›ä¸€ä¸ª YOLO æ£€æµ‹æ¨¡å‹ï¼Œå¯ä»¥é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚`get_validator` æ–¹æ³•åˆ™è¿”å›ä¸€ä¸ªç”¨äºéªŒè¯æ¨¡å‹çš„ `DetectionValidator` å®ä¾‹ï¼Œè®°å½•æŸå¤±åç§°å¹¶è®¾ç½®ä¿å­˜ç›®å½•ã€‚

`label_loss_items` æ–¹æ³•ç”¨äºè¿”å›å¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæŸå¤±å­—å…¸ï¼Œæ–¹ä¾¿åç»­çš„æŸå¤±è®°å½•å’Œåˆ†æã€‚`progress_string` æ–¹æ³•è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰çš„è½®æ¬¡ã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®ä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ç­‰ä¿¡æ¯ã€‚

`plot_training_samples` æ–¹æ³•ç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œå¸®åŠ©å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®ã€‚æœ€åï¼Œ`plot_metrics` å’Œ `plot_training_labels` æ–¹æ³•åˆ†åˆ«ç”¨äºç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡å’Œåˆ›å»ºå¸¦æ ‡ç­¾çš„è®­ç»ƒå›¾ï¼Œä¾¿äºåˆ†ææ¨¡å‹çš„æ€§èƒ½å’Œè®­ç»ƒæ•ˆæœã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„è®­ç»ƒæµç¨‹ï¼Œæ¶µç›–äº†æ•°æ®å‡†å¤‡ã€æ¨¡å‹è®­ç»ƒã€éªŒè¯å’Œç»“æœå¯è§†åŒ–ç­‰å¤šä¸ªæ–¹é¢ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·é«˜æ•ˆåœ°è®­ç»ƒ YOLO æ¨¡å‹è¿›è¡Œç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

è¯¥é¡¹ç›®ä¸»è¦æ˜¯ä¸€ä¸ªåŸºäºYOLOv8çš„ç›®æ ‡æ£€æµ‹å’Œåˆ†ç±»æ¡†æ¶ï¼ŒåŒ…å«äº†å¤šä¸ªæ¨¡å—å’Œæ–‡ä»¶ï¼Œç”¨äºå®ç°ä»æ•°æ®å‡†å¤‡ã€æ¨¡å‹è®­ç»ƒåˆ°æ¨ç†å’Œç»“æœå¯è§†åŒ–çš„å®Œæ•´æµç¨‹ã€‚æ•´ä½“æ¶æ„åˆ†ä¸ºå‡ ä¸ªä¸»è¦éƒ¨åˆ†ï¼š

1. **æ•°æ®å¤„ç†**ï¼šåŒ…æ‹¬æ•°æ®é›†çš„æ„å»ºã€æ•°æ®åŠ è½½å’Œé¢„å¤„ç†ï¼Œç¡®ä¿æ¨¡å‹èƒ½å¤Ÿæœ‰æ•ˆåœ°å­¦ä¹ ã€‚
2. **æ¨¡å‹å®šä¹‰**ï¼šå®ç°äº†YOLOv8æ¨¡å‹åŠå…¶æ”¹è¿›ç‰ˆæœ¬ï¼Œç»“åˆäº†å¤šç§å·ç§¯æ¨¡å—å’Œæ³¨æ„åŠ›æœºåˆ¶ï¼Œä»¥æå‡æ¨¡å‹æ€§èƒ½ã€‚
3. **è®­ç»ƒè¿‡ç¨‹**ï¼šæä¾›äº†è®­ç»ƒè„šæœ¬ï¼Œæ”¯æŒå¤šç§è®­ç»ƒé…ç½®ï¼Œèƒ½å¤Ÿè®°å½•æŸå¤±ã€ç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ç­‰ã€‚
4. **æ¨ç†ä¸é¢„æµ‹**ï¼šå®ç°äº†æ¨¡å‹çš„æ¨ç†åŠŸèƒ½ï¼Œèƒ½å¤Ÿå¯¹è¾“å…¥å›¾åƒè¿›è¡Œåˆ†ç±»å’Œç›®æ ‡æ£€æµ‹ã€‚
5. **å¯è§†åŒ–**ï¼šåŒ…æ‹¬ç»˜åˆ¶è®­ç»ƒæ ·æœ¬ã€æŸå¤±å’Œæ€§èƒ½æŒ‡æ ‡ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹å’Œæ•ˆæœã€‚

ä»¥ä¸‹æ˜¯æ¯ä¸ªæ–‡ä»¶çš„åŠŸèƒ½æ•´ç†è¡¨æ ¼ï¼š

| æ–‡ä»¶è·¯å¾„                                                                                              | åŠŸèƒ½æè¿°                                                                                           |
|-----------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| `code\ultralytics\solutions\ai_gym.py`                                                              | å®ç°äº†åŸºäºäººä½“å§¿æ€çš„å¥èº«åŠ¨ä½œè®¡æ•°å™¨ï¼Œç»“åˆå§¿æ€ä¼°è®¡å’Œå›¾åƒå¤„ç†æŠ€æœ¯ï¼Œå®æ—¶ç›‘æµ‹å¥èº«åŠ¨ä½œã€‚                      |
| `ui.py`                                                                                              | å¯åŠ¨ä¸€ä¸ªStreamlit Webåº”ç”¨ï¼Œç”¨äºæ–¹ä¾¿åœ°è¿è¡ŒæŒ‡å®šçš„Pythonè„šæœ¬ã€‚                                        |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\yolo\classify\predict.py` | æä¾›YOLOv8åˆ†ç±»æ¨¡å‹çš„é¢„æµ‹åŠŸèƒ½ï¼ŒåŒ…å«å›¾åƒé¢„å¤„ç†å’Œåå¤„ç†é€»è¾‘ã€‚                                         |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\extra_modules\RFAConv.py`  | å®šä¹‰äº†å¤šä¸ªè‡ªå®šä¹‰å·ç§¯æ¨¡å—å’Œæ¿€æ´»å‡½æ•°ï¼Œç»“åˆæ³¨æ„åŠ›æœºåˆ¶ä»¥æå‡YOLOv8æ¨¡å‹çš„æ€§èƒ½ã€‚                          |
| `train.py`                                                                                           | è´Ÿè´£YOLOæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é›†æ„å»ºã€æ¨¡å‹è®­ç»ƒã€æŸå¤±è®°å½•å’Œå¯è§†åŒ–ç­‰åŠŸèƒ½ã€‚                          |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\utils\__init__.py`      | åˆå§‹åŒ–YOLOv8æ¨¡å‹çš„å·¥å…·æ¨¡å—ï¼Œæä¾›å„ç§è¾…åŠ©åŠŸèƒ½ã€‚                                                    |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\engine\predictor.py`         | å®ç°æ¨¡å‹çš„æ¨ç†åŠŸèƒ½ï¼Œè´Ÿè´£å¤„ç†è¾“å…¥æ•°æ®å¹¶ç”Ÿæˆé¢„æµ‹ç»“æœã€‚                                             |
| `code\ultralytics\data\__init__.py`                                                                 | åˆå§‹åŒ–æ•°æ®å¤„ç†æ¨¡å—ï¼Œæä¾›æ•°æ®é›†ç›¸å…³çš„åŠŸèƒ½å’Œæ¥å£ã€‚                                                  |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\utils\callbacks\clearml.py`   | é›†æˆClearMLå·¥å…·ï¼Œæ”¯æŒè®­ç»ƒè¿‡ç¨‹ä¸­çš„å®éªŒç®¡ç†å’Œç›‘æ§ã€‚                                                |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\utils\benchmarks.py`         | æä¾›åŸºå‡†æµ‹è¯•åŠŸèƒ½ï¼Œç”¨äºè¯„ä¼°æ¨¡å‹çš„æ€§èƒ½å’Œæ•ˆç‡ã€‚                                                      |
| `code\ultralytics\models\utils\loss.py`                                                             | å®šä¹‰æŸå¤±å‡½æ•°ï¼Œç”¨äºè®­ç»ƒè¿‡ç¨‹ä¸­è®¡ç®—æ¨¡å‹çš„æŸå¤±å€¼ã€‚                                                    |
| `70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\extra_modules\block.py`    | å®ç°äº†ä¸€äº›åŸºæœ¬çš„ç¥ç»ç½‘ç»œæ¨¡å—ï¼Œä¾›YOLOv8æ¨¡å‹ä½¿ç”¨ã€‚                                                  |

è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº†æ¯ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå±•ç¤ºäº†é¡¹ç›®çš„æ•´ä½“æ¶æ„å’Œæ¨¡å—åŒ–è®¾è®¡ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/ZpuVmJ5x](https://mbd.pub/o/bread/ZpuVmJ5x)